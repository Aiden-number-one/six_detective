var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function TableTree1(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.element=t,this.menus="",this.ths=e.checkbox?["<th>全选</th>"]:[],this.trs=[],this.isTheadRendered=!1,this.index=0;this.options=_extends({indentSize:20,openAll:!1,checkbox:!1,widthScale:1},e);var n=this.element.width();this.widthPercentage=(n-40)*this.options.widthScale/Object.keys(this.options.data[0].columns).length+"px",this.init(),this.bindEvent()}TableTree1.prototype.init=function(){var t=this.generateTableTree1("id","pId",this.options.data);this.element.html(t),App.initUniform()},TableTree1.prototype.format=function(t){return"object"===(void 0===t?"undefined":_typeof(t))&&t?t.formatter():t},TableTree1.prototype.formatTitle=function(t){return"object"===(void 0===t?"undefined":_typeof(t))?"":t},TableTree1.prototype.renderTd=function(t,e,n){return this.isFirstTd?(this.isFirstTd=!1,'<td style="max-width: '+this.widthPercentage+'" class="ellipsis" title=\''+this.formatTitle(e[t])+'\'> \n\t                <span class="table-row-indent indent-level-0" style="padding-left: '+this.index*this.options.indentSize+'px;"></span>\n\t                <span class="table-row-expand-icon '+(n?"table-row-collapsed":"table-row-spaced")+'"></span>\n\t                '+this.format(e[t])+" \n\t            </td>"):'<td style="max-width: '+this.widthPercentage+'"  class="ellipsis" title=\''+this.formatTitle(e[t])+"'> "+this.format(e[t])+" </td>"},TableTree1.prototype.renderTdCheckbox=function(t){return this.options.checkbox?'<td class="width40">\n                        <input type="checkbox" '+t+" />\n                    </td>":""},TableTree1.prototype.generateTableTree1=function(t,e,n){var i=!0,o=!1,r=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var h=s.value;this.index++;var d="",l=h.hasOwnProperty("children")&&0<h.children.length;this.isFirstTd=!0;var c="";if(h.hasOwnProperty("attr")){var p=h.attr;for(var y in p)c+=y+"='"+p[y]+"' "}for(var f in h.columns)this.isTheadRendered||this.ths.push('<th class="t-l" style="min-width:40px"> '+f+" </th>"),d+=this.renderTd(f,h.columns,l);this.isTheadRendered=!0,this.trs.push('<tr key="'+h[t].replace(/ /g,"")+'" pKey="'+h[e].replace(/ /g,"")+'" level="'+this.index+'" style="display: '+(1===this.index?"table-row":"none")+'">\n\t\t\t\t\t\t'+this.renderTdCheckbox(c)+"\n\t\t\t\t\t\t"+d+"\n\t\t\t\t\t</tr>"),l&&this.generateTableTree1(t,e,h.children),this.index--}}catch(t){o=!0,r=t}finally{try{!i&&a.return&&a.return()}finally{if(o)throw r}}return"<thead>\n                <tr>\n                    "+this.ths.join(",")+"\n                </tr>\n            </thead>\n            <tbody>\n            \t"+this.trs.join(",")+"\n           \t<tbody>"},TableTree1.prototype.openNode=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=$('[key="'+t+'"]'),i=$('[pkey="'+t+'"]'),o=this;i.show(),e&&n.find(".table-row-expand-icon").removeClass("table-row-collapsed").addClass("table-row-expanded"),$.each(i,function(){var t=0<$(this).find(".table-row-expanded").length,e=$(this).attr("key");t&&o.openNode(e,!1)})},TableTree1.prototype.closeNode=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=$('[key="'+t+'"]'),i=$('[pkey="'+t+'"]'),o=this;i.hide(),e&&n.find(".table-row-expand-icon").removeClass("table-row-expanded").addClass("table-row-collapsed"),$.each(i,function(){var t=0<$(this).find(".table-row-expanded").length,e=$(this).attr("key");t&&o.closeNode(e,!1)})},TableTree1.prototype.bindEvent=function(){var r=this;this.element.find(".table-row-expand-icon").click(function(){var t=$(this).hasClass("table-row-collapsed"),e=$(this).closest("tr").attr("key");t?r.openNode(e):r.closeNode(e)}),this.element.find("tbody tr input[type=checkbox]:not(.make-switch)").change(function(){var t=$(this).is(":checked"),e=$(this).closest("tr").attr("key"),n=$(this).closest("tr").attr("pkey");!function e(n,t){r.element.find("tbody tr[pkey='"+t+"']").each(function(){$(this).find("input[type=checkbox]:not(.make-switch)").prop("checked",n);var t=$(this).attr("key");e(n,t)})}(t,e),function t(e,n){if("-1"!==n){var i=e;e&&r.element.find("tbody tr[pkey='"+n+"']").each(function(){$(this).find("input[type=checkbox]:not(.make-switch)").prop("checked")||(i=!1)}),r.element.find("tbody tr[key='"+n+"'] input[type=checkbox]:not(.make-switch)").prop("checked",i);var o=r.element.find("tbody tr[key='"+n+"']").attr("pkey");t(i,o)}}(t,n),jQuery.uniform.update()})},$.fn.TableTree1=function(t){return new TableTree1(this,t)};