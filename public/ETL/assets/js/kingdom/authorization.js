define(function(require,exports,module){require("cookie"),require("blockui"),require("uniform"),require("switch"),require("toastr"),require("plugins/jquery-validation/js/jquery.validate"),require("js/kingdom/kd.ui.plugin"),require("js/kingdom/handlebars.helper"),require("js/kingdom/handlebars.helper.common"),require("ajaxdata"),require("plugins/jquery-validation/js/localization/messages_zh.min");require("api_name"),require("base64"),require("json2"),require("md5"),require("js/kingdom/kjax.des"),require("js/kingdom/jquery.kingdom"),require("js/kingdom/kdata");$(function(){$("body").on("click","#J_authorization_sys_platform_save",function(){if(""!==$("#J_authorization_platform_date [name=file]").val()){var a=$.des.getDes($("#J_authorization_platform_date input[name='passWord']").val());$("#J_authorization_platform_date input[name='passWord']").val(a),$("#J_authorization_platform_date").validate().form()&&$.kingdom.uploadWithApi("J_authorization_platform_date","update_auth_info",function(a){"1"==a.bcjson.flag?($("#J_authorization_upload_modal").modal("hide"),toastr.success(a.bcjson.msg),getAuthorizationTime(),$("#authorization_reset").click()):("非法拷贝"===a.bcjson.msg&&(a.bcjson.msg="无效的授权信息"),toastr.error(a.bcjson.msg))})}else toastr.info("请选择文件")}),(getAuthorizationTime=function(){var a={url:window.location.origin+"/retl/rest/admin/v4.0/bayconnect.superlop.get_auth_info.json",type:"POST",dataType:"json",success:function(a){if("1"==a.bcjson.flag&&a.bcjson.items&&0<a.bcjson.items.length){var o=a.bcjson.items[0],t=o.date.substring(0,4)+"-"+o.date.substring(4,6)+"-"+o.date.substring(6,8);$("#J_authorization_platform_date #authorization_date").val(t)}},error:function(a){toastr.error(a.bcjson.msg)}};$("#login_authorization_date").ajaxSubmit(a)})(),$("#J_authorization_platform_date").validate({debug:!0,errorElement:"span",errorClass:"help-block",focusInvalid:!1,rules:{date:{},userName:{required:!0,maxlength:50},passWord:{required:!0,maxlength:50}},invalidHandler:function(){},highlight:function(a){$(a).closest(".form-group").addClass("has-error")},success:function(a){a.closest(".form-group").removeClass("has-error"),a.remove()},errorPlacement:function(a,o){a.insertAfter(o)},submitHandler:function(){}})})});