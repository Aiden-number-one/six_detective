define(function(require,exports,module){window.App=require("app");var e=require("./kweb");require("js/layouts/layout.min"),require("js/layouts/demo.min"),require("plugins/jquery-validation/js/jquery.validate"),require("plugins/jquery-validation/js/additional-methods.js"),require("plugins/jquery-validation/js/localization/messages_zh.min.js"),require("plugins/fullcalendar/fullcalendar"),require("plugins/fullcalendar/lib/moment.min"),require("plugins/fullcalendar/lang/zh-cn"),require("assets/plugins/colresizable/colResizable-1.6");var a=[],c=(e.kingdom.kconfig().theme,e.kingdom.kconfig().root);$.kingdom.kconfig().developer&&(console.log=function(){});function i(a,e){a=a||"index",history.pushState&&("common-page"==!a?history.pushState("","","index.html#"+a):"index"==a&&history.pushState("","","index.html")),$(".loading").remove(),$("#js_page_row,#index_page").hide(),$(".page-container").show();var i="",n="";if(-1<a.indexOf("common-page")&&!e){i="common-page";var t=a.substr(a.indexOf("?")+1,a.length);t=t.split("&");for(var s="{",o=0;o<t.length;o++){var l=t[o].split("=");"page"==l[0]?n=l[1]:s+='"'+l[0]+'":"'+l[1]+'",'}s=s.substr(0,s.length-1),s+="}",s=JSON.parse(s),$("#local-data").data("params",s)}else i=a.replace("#",""),n=e||i;var d=c+i+"/"+n;(new Date).getTime(),$.ajax({url:d+".html",dataType:"html",beforeSend:function(){App.blockUI({target:".page-content",overlayColor:"none",cenrerY:!0,animate:!0})},success:function(e){if(window.x_trace_page_id=$.kingdom.uuid(),null==e.match("<!DOCTYPE html>")){if(-1<a.indexOf("common-page"))$(".margin-top-20").fadeOut(),$("#js_page_common").html(e),$("#js_page_common").removeAttr("class").addClass("margin-top-20 page-"+i+" page-common-"+n),$("#js_page_common").fadeIn();else{if($("#js_page_common").hide(),$(".margin-top-20").hide(),$(".page-tabs-content a").removeClass("active"),0<$(".page-tabs-content a[data-titleId='"+i+"']").length)$(".page-tabs-content a[data-titleId='"+i+"']").addClass("active"),$("#"+i).show();else if("index"==a)$(".page-tabs-content a").eq(0).addClass("active"),$("#js_page_row").removeAttr("class").addClass("margin-top-20 page-"+i).html(e).show();else if(0===$(".page-tabs-content a[data-titleId='"+i+"']").length){var t=$("a[href=#"+a+"] span").html();"indexInformation"==a&&(t="信息统计"),$(".page-tabs-content").append('<a href="javascript:;" class="active J_menuTab" data-titleId="'+i+'">'+t+' <i class="fa fa-times-circle"></i></a>'),$(".page-content").append('<div id="'+i+'" class="margin-top-20 J_htmlTab page-'+i+'" style="display:none;"></div>'),$("#"+i).html(e).show()}p(),App.runResizeHandlers()}require.async(d+".js",function(e){e&&e.load&&(e.load(),h(".page-"+i),g(".page-"+i),$(".page-"+i+" .table").colResizable({liveDrag:!0,draggingClass:"dragging",resizeMode:"flex"}))}),r()}else toastr.info("请刷新当前页面重新登录。","登录失效！")},error:function(){var e='<div class="row"><div class="col-md-12 page-404"><div class="number font-red"> 404 </div><div class="details"><h3>啊唷，您要找的页面发生了意外。</h3><p>我们无法找到这个页面。<br/><p><a href="" class="btn red btn-outline"> 刷新试试 </a> 或<a href="index.html" class="btn red btn-outline"> 返回首页 </a><br> </p></div></div></div>';"common-page"==a?$("#js_page_common").removeAttr("class").addClass("margin-top-20 page-"+i).html(e).show():$("#js_page_row").removeAttr("class").addClass("margin-top-20 page-"+i).html(e).show()},complete:function(){App.unblockUI(".page-content")}})}function n(e){var t=$("li.nav-item"),a=($("li.nav-item a"),$("li.nav-item a[href=#"+e+"]"));(e||""==e)&&a&&a.length&&(t.removeClass("active open"),t.find(".arrow").removeClass("active open"),t.find(".selected").remove(),2==a.length?a.eq(1).parents(".nav-item").addClass("active open"):a.eq(0).parents(".nav-item").addClass("active open"),a.eq(0).parents(".nav-item").children(".nav-toggle").append("<span class='selected'></span>"),a.eq(0).parents(".nav-item").children(".nav-link").find(".arrow").addClass("open"))}var r=function(){$(".page-breadcrumb").empty(),$(".page-breadcrumb").append('<li><a href="index.html" style="color: #0C95E8;">主页</a></li>'),$(".active.open>a .title").each(function(e,t){a[e]=$(t).html(),$(".page-breadcrumb").append('<li><i class="fa fa-angle-right"></i><span></span></li>'),$(".page-breadcrumb li").eq(e+1).find("span").html($(t).html())})},p=function(){var e=navigator.userAgent.toLowerCase();if(-1<e.indexOf("ipad")||-1<e.indexOf("iphone")||-1<e.indexOf("android")||-1<e.indexOf("Android")||-1<e.indexOf("iPhone")){$("#head-navBtn").find("span").hide(),$("#head-navBtn").find("span").hide(),$(".tourist-wide a").each(function(){var e=$(this).find("i");$(this).html(e)})}else{var t;if(window.innerWidth?t=window.innerWidth:document.body&&document.body.clientWidth&&(t=document.body.clientWidth),t<800){$("#head-navBtn").find("span").hide();$(".tourist-wide a")}else $("#head-navBtn").find("span").show();$(window).resize(function(){$(this).width()<800?($("#head-navBtn").find("span").hide(),$("#head-navBtn").find("span").hide()):$("#head-navBtn").find("span").show()})}},h=function(e){if(0!==$(e+" .slide-toggle").length){$("body").width();var t=$(e+" .left-side").width(),a=($(".page-logo").outerWidth(),$(e+" .slide-toggle").position().left);$(e+" .right-content").css("width","calc(100% - "+(t+10)+"px)"),$(e+" .slide-toggle").click(function(){0<$(this).find(".fa-angle-left").length?($(this).siblings(".left-side").width(0),$(this).css({left:0}),$(this).siblings(".right-content").css("width","100%"),$(this).html('<i class="slide-icon fa fa-angle-right"></i>')):($(this).siblings(".left-side").width(t),$(this).css({left:a}),$(this).siblings(".right-content").css("width","calc(100% - "+(t+10)+"px)"),$(this).html('<i class="slide-icon fa fa-angle-left"></i>'))})}},g=function(e){if(0!==$(e+" .slide-toggle1").length){var t=$(e+" .left-side").width();$(e+" .right-content").css("width","calc(100% - "+(t+10)+"px)");var a=$(e+" .drag_bar").position().left;$(e).on("click",".slide-toggle1",function(){0<$(this).find(".fa-angle-left").length?($(".drag_bar").siblings(".left-side").width(0),$(".drag_bar").css({left:0}),$(".drag_bar").siblings(".right-content").css("width","100%"),$(this).html('<i class="slide-icon fa fa-angle-right"></i>'),$(this).css({left:0})):($(".drag_bar").siblings(".left-side").width(t),$(".drag_bar").css({left:a}),$(this).css("left",a-20),$(".drag_bar").siblings(".right-content").css("width","calc(100% - "+(t+10)+"px)"),$(this).html('<i class="slide-icon fa fa-angle-left"></i>'))})}};$(function(){var e=window.location.hash.substr(1).split("?")[0];i(e),$("body").on("click","[data-toggle=collapse].collapse-control",function(){0<$(this).find(".fa-sort-desc").length?$(this).html('<i class="fa fa-sort-asc"></i><span>'+$.i18n.map.Collapse+"</span>"):$(this).html('<i class="fa fa-sort-desc"></i><span>'+$.i18n.map["Search-More"]+"</span>")}),$("body").on("click","[data-toggle=collapse] span, [data-toggle=collapse] i",function(e){e.stopPropagation(),$(this).parent().click()}),$("body").on("click","[data-toggle='link']",function(){var e=$(this).attr("href").split("#")[1];if($("#local-data").data("params",$(this).data("params")),$("#local-data").data("source",$(this).data("source")),"common-page"==e){var t=$(this).data("linkto");return i(e,t),!1}}),$("body").on("click",".js-backtolist",function(){if(-1<location.href.indexOf("?page"))window.close();else{$("#js_page_common").fadeOut();var e=location.hash;$(e).fadeIn(),$(this).is("[refresh]")&&i($(".J_menuTab.active").data("titleid"))}}),window.util={},window.util.highlightNav=n,toastr.options.closeButton=!0,toastr.options.setTimeout="500",toastr.options.positionClass="toast-top-center",bootbox.setDefaults({title:"Tips"}),$("#js-logout1").click(function(){$(this);bootbox.confirm("确定退出当前系统吗？",function(e){e&&$.kingdom.logout(function(e){App.blockUI({boxed:!0,message:"正在退出"}),1==e.bcjson.flag?window.setTimeout(function(){App.unblockUI(),window.location.href="/login.html"},1e3):(App.unblockUI(),toastr.success(e.bcjson.msg))})})}),$(window).bind("hashchange",function(){var e=window.location.hash.substr(1);if("#report-table-info-manage"!==location.hash){var t=location.href.replace(location.search,"");window.location.href=t}-1<e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),i(e),n(e)}),$("body").on("click",".nav-link",function(){var e=$(this).attr("href"),t=location.hash===e;if(-1<e.indexOf("#")&&t){var a=e.replace("#","");i(a),n(a)}}),$("body").on("change",".date-picker,.date-time-picker,select[data-select2-id]",function(){0<$(this).closest("form").length&&$(this).closest("form").validate().element(this)}),$("body").on("click",".sidebar-toggler",function(){var e=".page-"+location.hash.substring("1"),t=($(e+" .right-content").width(),$(e+" .left-side").width());0<$(e+" .slide-toggle .fa-angle-left").length?$(e+" .right-content").css("width","calc(100% - "+(t+9)+"px)"):$(e+" .right-content").css("width","calc(100% - "+t+"px)"),$(this).hasClass("close-flag")?($(".page-sidebar-menu.page-sidebar-menu-hover-submenu>li:last > .sub-menu").css({bottom:"0"}),$(this).removeClass("close-flag")):($(".page-sidebar-menu.page-sidebar-menu-hover-submenu>li:last > .sub-menu").css({bottom:"auto"}),$(this).addClass("close-flag"))}),$("body").on("mouseover","#header_notification_bar",function(){$(this).addClass("open")}),$("body").on("mouseout","#header_notification_bar",function(){$(this).removeClass("open")}),$("body").on("click","[type=jstree], [type=treeselectchild], .jstree-ocl, .jstree-closed",function(e){e.stopPropagation()}),$("body").on("click","[type=jstree] .jstree-anchor",function(e){e.stopPropagation(),$(this).parents("[type=jstree]").siblings("input[type=hidden]").val($(this).parent().attr("folderid")),$(this).parents("[type=jstree]").siblings(".dropdown-toggle").val($(this).text()).attr("aria-expanded","false").parent().removeClass("open")}),$("body").on("click",".dropdown-toggle[name='folderName'][data-toggle=dropdown]+i",function(e){e.stopPropagation(),$(this).parent().toggleClass("open")}),$("body").on("click",".dropdown-toggle[name='jobName'][data-toggle=dropdown]+i",function(e){e.stopPropagation(),$(this).parent().toggleClass("open")}),$("body").on("click","tbody tr .bootstrap-switch-label",function(e){e.stopPropagation()})})});