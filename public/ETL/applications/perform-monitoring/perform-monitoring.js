define(function(require,exports,module){var i=require("./perform-monitoringShow");require("plugins/jquery-validation/js/jquery.validate");var e=location.hash.split("?")[0].replace("#",".page-"),t={load:function(){i._load();var e=document.getElementById("J_drag_bar8"),t=document.getElementById("J_drag_bar8");startDrag(e,t,".left-side-monitoring",".right-content-monitoring",function(){LFWIDTH=$(".left-side1").width()}),$("#perform-monitoring").css("margin-top",0)}};saveJobid="",saveBatchNo="",$(function(){$("body").on("click","#perform-monitoring .img-absolute-block .img-absolute",function(){if(0===$("#perform-monitoring .img-absolute-block .img-absolute").index($(this))){var e=$("#right-content-middle-round").scrollLeft()-868;$("#right-content-middle-round").animate({scrollLeft:e+"px"},300)}else{e=$("#right-content-middle-round").scrollLeft()+868;$("#right-content-middle-round").animate({scrollLeft:e+"px"},300)}}),$("body").on("click","#perform-monitoring [href=#J_tps_1_4]",function(){$(".my_search").removeClass("hide"),$(".search").addClass("hide")}),$("body").on("click","#perform-monitoring [href=#J_tps_1_5]",function(){$(".search").removeClass("hide"),$(".my_search").addClass("hide")}),$("body").on("click","#perform-monitoring .circleChart-box",function(){var e={};e.jobId=$("#perform-monitoring #right-content-top #J_pm_top_jobno").attr("jobId"),e.batchNo=$(this).find(".circleChart-text div").html();var t=$(this).find(".circleChart-text div"),a={batchNo:t.attr("batchNo"),zxsj:t.attr("zxsj"),jobName:t.attr("jobname"),jobId:t.attr("jobid"),jobNo:t.attr("jobno"),errorNum:t.attr("errornum"),startTime:t.attr("starttime"),endTime:t.attr("endtime"),executeTypeName:t.attr("executetypeName"),executeFlag:t.attr("executeflag"),isDependNewExecute:"1",newExecuteFlag:$("#right-content-middle-round .circleChart-text:eq(0) div").attr("executeflag")};i.getThirdBoardData(a,e,!0)}),window.addEventListener("hashchange",function(e){if("perform-monitoring"===e.oldURL.split("#")[1]){clearInterval(i.setIntervalLeftBox),clearInterval(i.timeInterval),clearInterval(i.setInterval);var t=$("#perform-monitoring #J_change_view_job iframe")[0].contentWindow;t.clearInterval(t.setIntervalVarIframe)}}),$("body").on("keydown","#perform-monitoring #J_pm_jobname_tree_search",function(e){13==e.keyCode&&$("#perform-monitoring #J_pm_jobname_tree_search_btn").click()}),$("body").on("keydown","#perform-monitoring #J_pm_jobname_my_tree_search",function(e){13==e.keyCode&&$("#perform-monitoring #J_pm_jobname_my_tree_search_btn").click()}),$("body").on("mouseenter","#J_pm_jobname_tree .jstree-anchor",function(e){if(e.stopPropagation(),e.preventDefault(),1!==$(this).find(".jstree-operate").length){var t=$(this).closest("li").attr("aria-level");1!==$(this).find(".jstree-operate").length&&("1"===t||("2"===t?$(this).append('<div class="jstree-operate"><a name="add" title="添加到我的"><i class="fa fa-plus-circle" style="color: #3fc9d5"></i></a></div>'):"3"===t?$(this).append('<div class="jstree-operate"><a name="add" title="添加到我的"><i class="glyphicon glyphicon-plus"></i></a><a name="edit" title="编辑"><i class="glyphicon glyphicon-pencil"></i></a></div>'):$(this).append('<div class="jstree-operate"><a name="add" title="添加到我的"><i class="glyphicon glyphicon-plus"></i></a></div>')))}}),$("body").on("mouseenter","#J_pm_jobname_my_tree .jstree-anchor",function(e){if(e.stopPropagation(),e.preventDefault(),1!==$(this).find(".jstree-operate").length){var t=$(this).closest("li").attr("aria-level");1!==$(this).find(".jstree-operate").length&&("1"===t||("2"===t?$(this).append('<div class="jstree-operate"><a name="del" title="删除"><i class="fa fa-times-circle"></i></a></div>'):$(this).append('<div class="jstree-operate"><a name="del" title="删除"><i class="glyphicon glyphicon-trash"></i></a></div>')))}}),$("body").on("mouseleave","#J_pm_jobname_tree .jstree-anchor",function(){$(".jstree-operate").remove()}),$("body").on("mouseleave","#J_pm_jobname_my_tree .jstree-anchor",function(){$(".jstree-operate").remove()}),$("#J_pm_jobname_tree").on("click",".jstree-operate [name=add]",function(e){var t={};return e.stopPropagation(),e.preventDefault(),t.jobId=$(this).closest(".jstree-anchor").attr("jobid"),console.log(t),i.addMyTree(t),!1}),$("#J_pm_jobname_my_tree").on("click",".jstree-operate [name=del]",function(e){var t={};return e.stopPropagation(),e.preventDefault(),t.jobId=$(this).closest(".jstree-anchor").attr("jobid"),i.delMyTree(t),!1}),$("body").on("click","#perform-monitoring #J_pm_jobname_tree_search_btn",function(){var e={jobName:$("#perform-monitoring #J_pm_jobname_tree_search").val()};clearInterval(i.setIntervalLeftBox),i.getLeftBoxList(e,!0),i.setIntervalLeftBox=setInterval(function(){i.getLeftBoxList(e,!0)},2e3)}),$("body").on("click","#perform-monitoring #J_pm_jobname_my_tree_search_btn",function(){var e={jobName:$("#perform-monitoring #J_pm_jobname_my_tree_search").val(),info:"focus"};i.getLeftBoxMyList(e,!0)}),$("body").on("click","[href=#pm-tab_1_3]",function(e){var t=$("#J_pm_tab3_body .checked"),a=[];$.each(t,function(e,t){$(t).closest("tr").data("params").taskVars&&a.push($(t).closest("tr").data("params").taskVars)}),a=function(e){for(var t=[],a=0;a<e.length;a++)-1==t.indexOf(e[a])&&t.push(e[a]);return t}(a.join(",").split(","));var o={};o.varInfo=a.join(","),$.extend(o,i.jobId),i.variableSetting(o)}),$("body").on("click","#perform-monitoring  #J_pm_jobname_tree .jstree-children .jstree-children a,#perform-monitoring  #J_pm_jobname_my_tree .jstree-children .jstree-children a",function(){clearInterval(i.setInterval),clearInterval(i.timeInterval),i.handleParams.delAllRow(),$("#perform-monitoring #pm-add li:eq(0) a").click(),$("#right-content-table").css({display:"block"});var e=$(this).attr("jobid"),t=$(this).attr("batchno"),a=$(this).attr("executeflag");saveJobid=e,saveBatchNo=t;var o={};o.jobId=e;var r={};r.jobId=e,r.batchNo=t,$("#J_change_view_job iframe").attr("src","/retl-process/monitor.html"),$("#J_tableList").jstree("destroy"),t&&"null"!==t?(i.getTableData(r,a),$("#J_change_view_job iframe").attr("src","/retl-process/monitor.html?jobId="+e+"&batchNo="+t)):($("#perform-monitoring-table-tree").empty(),$("#perform-monitoring-table-tree").html('<div id="J_tableList" style="text-align:center;padding:8px 0;">暂无数据</div>')),"N"!==a&&"null"!==a||i.getRightTopBoxList(o)}),$.kingdom.getDict("BATCH_FORMAT","#BatchNumberFormat"),$("body").on("click",".page-perform-monitoring  #J_perform_task",function(){var n={};n.isConfirm=$("#pm-tab_1_1 input[name=isConfirm]:checked").val(),i.handleParams&&i.handleParams.getData(function(e){n.inputVarList=e;var t=!0,a=!1,o=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){delete r.value.no}}catch(e){a=!0,o=e}finally{try{!t&&i.return&&i.return()}finally{if(a)throw o}}}),n.inputVarList=n.inputVarList.length?JSON.stringify(n.inputVarList):"","option1"===$("input[name='optionsRadios']:checked").val()?n.startFrom=JSON.stringify($("#J_pm_tab3_select option:selected").data("params")):(n.partTaskList=[],$.each($("#J_pm_tab3_table input:checked"),function(){$(this).closest("tr").data("params")&&n.partTaskList.push($(this).closest("tr").data("params"))}),n.partTaskList=n.partTaskList.length?JSON.stringify(n.partTaskList):""),n.jobId=i.jobId.jobId,i.performTask(n)}),$("body").on("click",".page-perform-monitoring #J_start_task",function(){var e=$(this).find("img").hasClass("current-play"),t=$(this).find("img").hasClass("static");return e?(bootbox.confirm("确定终止该任务吗?",function(e){if(e){App.blockUI({boxed:!0,message:"终止中..."});var t=i.jobId.jobId,a=$("#circle0").siblings(".circleChart-text").find("div").text();i.stopCurrentTask(t,a)}}),!1):!t&&void $("#pm-add").modal("show")}),$("body").on("click",".page-perform-monitoring #perform-monitoring-table-tree .execute-error-msg",function(){var e=$(this).attr("msg");$("#pg-perform-detail-modal").modal("show"),$("#pg-perform-detail-modal-msg").html(e.replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;"))}),$("body").on("click",".page-perform-monitoring #J_change_view",function(){var e=saveJobid,t=saveBatchNo;if(e)if($("#J_change_view_table").is(":visible"))$("#J_change_view_table").hide(),$("#J_change_view_job").show(),$("#J_change_view_job iframe").attr("src","/retl-process/monitor.html?jobId="+e+"&batchNo="+t);else{$("#J_change_view_table").show(),$("#J_change_view_job").hide();var a=$("#perform-monitoring #J_change_view_job iframe")[0].contentWindow;a.clearInterval(a.setIntervalVarIframe)}}),$("body").on("click","#perform-monitoring #pm-tab_1_3 [name=oparate]",function(){var e=$(this).data("type");"add"===e?i.handleParams.addRow():"delAll"===e?i.handleParams.delAllRow():"del"===e&&i.handleParams.delRow($(this))}),$("body").on("change","#perform-monitoring #pm-tab_1_3 input[type=checkbox],#perform-monitoring #pm-tab_1_3 #J_pm_tab3_select",function(){$(this).closest(".form-group").find(".radio input")[0].click()}),$("body").on("click",e+" .fullscreen",function(){$(this).hasClass("on")?($("#J_change_view_table").css("height","calc(100vh - 65px"),$("#J_change_view_job iframe").css("height","calc(100vh - 65px")):($("#J_change_view_table").css("height",360),$("#J_change_view_job iframe").css("height",360))}),$("body").on("change",e+' [name="optionsRadios"]',function(){"option1"===$(this).val()?($("#J_pm_tab3_select").show(),$("#J_pm_tab3_table").hide()):($("#J_pm_tab3_select").hide(),$("#J_pm_tab3_table").show())})}),module.exports=t});