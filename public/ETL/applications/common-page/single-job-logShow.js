var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define(function(require,exports,module){var n={};function S(e,t){var r;return"B"===t?r="#ed6b75":"R"===t?r="#659be0":"S"===t?r="#3fc9d5":"F"===t?r="#F1C40F":"N"===t&&(r="#bac3d0"),'<span style="color:'+r+'">'+e+"</span>"}function k(e,t,r){return'<span style="margin-right: 10px;" title=\''+e+"' >"+e+("F,B".includes(t)?"<i class='fa fa-info-circle' title='"+r.substring(0,100)+"'></i>":"")+"</span>"}function F(e){return'<span class="execute-error-msg" msg=\''+e.replace(/\'/g,'"')+'\' style="color:#3fc9d5;cursor:pointer;">'+e.substring(0,100)+"</span>"}function o(I){var e=!0,t=!1,r=void 0;try{function n(){var r=j.value;if(!r.parentMonitorId){var o=[{id:r.monitorId,pId:"-1",columns:{"序号":r.orderNo,"节点":{formatter:function(){return k(r.nodeName,r.executeFlag,r.executeMsg)}},"任务名称":r.jobName,"任务类型":r.memberTypeName,"删除":r.deleteNum,"插入":r.insertNum,"开始时间":$.kingdom.toDateTime(r.startTime),"结束时间":$.kingdom.toDateTime(r.endTime),"执行时长":$.kingdom.formatMillisecond(r.duration),"执行状态":{formatter:function(){return S(r.executeFlagName,r.executeFlag)}},"执行信息(点击显示全部信息)":{formatter:function(){return F(r.executeMsg)}}},children:[]}],e=!0,t=!1,n=void 0;try{function a(){var e=i.value;if(e.parentMonitorId===r.monitorId){var t={id:e.monitorId,pId:e.parentMonitorId,attr:{obj:JSON.stringify(e)},columns:{"序号":e.orderNo,"节点":{formatter:function(){return k(e.nodeName,e.executeFlag,e.executeMsg)}},"任务名称":e.jobName,"任务类型":e.memberTypeName,"删除":e.deleteNum,"插入":e.insertNum,"开始时间":$.kingdom.toDateTime(e.startTime),"结束时间":$.kingdom.toDateTime(e.endTime),"执行时长":$.kingdom.formatMillisecond(e.duration),"执行状态":{formatter:function(){return S(e.executeFlagName,e.executeFlag)}},"执行信息(点击显示全部信息)":{formatter:function(){return F(e.executeMsg)}}},children:[]};o[0].children.push(t)}}for(var i,l=I[Symbol.iterator]();!(e=(i=l.next()).done);e=!0)a()}catch(e){t=!0,n=e}finally{try{!e&&l.return&&l.return()}finally{if(t)throw n}}for(var c=o[0].children,u=0,m=c.length;u<m;u++){var d=!0,f=!1,s=void 0;try{function g(){var e=b.value;if(e.parentMonitorId===c[u].id){var t={id:e.monitorId,pId:e.parentMonitorId,attr:{obj:JSON.stringify(e)},columns:{"序号":e.orderNo,"节点":{formatter:function(){return k(e.nodeName,e.executeFlag,e.executeMsg)}},"任务名称":e.jobName,"任务类型":e.memberTypeName,"删除":e.deleteNum,"插入":e.insertNum,"开始时间":$.kingdom.toDateTime(e.startTime),"结束时间":$.kingdom.toDateTime(e.endTime),"执行时长":$.kingdom.formatMillisecond(e.duration),"执行状态":{formatter:function(){return S(e.executeFlagName,e.executeFlag)}},"执行信息(点击显示全部信息)":{formatter:function(){return F(e.executeMsg)}}},children:[]};o[0].children[u].children.push(t)}}for(var b,y=I[Symbol.iterator]();!(d=(b=y.next()).done);d=!0)g()}catch(e){f=!0,s=e}finally{try{!d&&y.return&&y.return()}finally{if(f)throw s}}var p=o[0].children[u].children,h=!0,v=!1,N=void 0;try{function x(){for(var e=T.value,t=0,r=p.length;t<r;t++)if(e.parentMonitorId===p[t].id){var n={id:e.monitorId,pId:e.parentMonitorId,attr:{obj:JSON.stringify(e)},columns:{"序号":e.orderNo,"节点":{formatter:function(){return k(e.nodeName,e.executeFlag,e.executeMsg)}},"任务名称":e.jobName,"任务类型":e.memberTypeName,"删除":e.deleteNum,"插入":e.insertNum,"开始时间":$.kingdom.toDateTime(e.startTime),"结束时间":$.kingdom.toDateTime(e.endTime),"执行时长":$.kingdom.formatMillisecond(e.duration),"执行状态":{formatter:function(){return S(e.executeFlagName,e.executeFlag)}},"执行信息(点击显示全部信息)":{formatter:function(){return F(e.executeMsg)}}},children:[]};o[0].children[u].children[t].children.push(n)}}for(var T,M=I[Symbol.iterator]();!(h=(T=M.next()).done);h=!0)x()}catch(e){v=!0,N=e}finally{try{!h&&M.return&&M.return()}finally{if(v)throw N}}}return{v:o}}}for(var j,o=I[Symbol.iterator]();!(e=(j=o.next()).done);e=!0){var a=n();if("object"===(void 0===a?"undefined":_typeof(a)))return a.v}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}n._load=function(){n.getSingleDatasourceList()},n.getSingleDatasourceList=function(e){var t={jobId:$("#local-data").data("params").jobId,batchNo:$("#local-data").data("params").batchNo,pageNumber:1e3,pageSize:1};t=$.extend(t,e),n.getTableData1(t)},n.getTableData1=function(e){$("#right-content-table").show();var t=$.extend({},e);$.kingdom.doKoauthAdminAPI("kingdom.retl.get_monitor_log_detail_info","v4.0",t,function(e){var t=e.bcjson.items||e.bcjson;if("1"==e.bcjson.flag)if($("#J_tableList").jstree("destroy"),0<t.length){n.currentMsgCollection={},$.each(t,function(e,t){n.currentMsgCollection[e]=t.executeMsg,t.errorIndex=e});var r=o(t);$("#single-job-log-table-tree").tableTree({data:r}),$("#single-job-log-table-tree").tableTree({widthScale:2,data:r}).openNode($('[pkey="-1"]').attr("key"))}else $("#J_tableList").html("<image src='assets/img/nonedata.png'/>").css("text-align","center");else toastr.error(e.bcjson.msg)})},module.exports=n});