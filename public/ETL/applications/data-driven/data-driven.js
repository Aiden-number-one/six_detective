define(function(require,exports,module){var i=require("./data-drivenShow");require("plugins/jquery-validation/js/jquery.validate.js"),require("plugins/jquery-validation/js/additional-methods.js");var e={load:function(){i._load();var e=document.getElementById("J_drag_bar6"),d=document.getElementById("J_drag_bar6");startDrag(e,d,".left-side-driven",".right-content-driven",function(){LFWIDTH=$(".left-side").width()})}};$(function(){$("body").on("keydown","#data-driven #J_dd_list_search",function(e){13==e.keyCode&&$("#data-driven #dd-search").click()}),$("body").on("click","#data-driven #dd-search",function(){var e=$(this).siblings("input").val();i.get_Driven_List(e)}),$("body").on("click","#data-driven #dd-clear-button",function(){$("#driven_Data_View_Detail").html('<tr><td colspan="4" class="t-c">暂无</td></tr>'),App.clearForm("driven-datatable-view")}),$("body").on("click","#filebutton",function(){$("#dd-inputfile").click()}),$("body").on("click","#filebutton-add",function(){$("#dd-inputfile-add").click()}),$("body").on("change","#dd-inputfile-add",function(e){$("#filename-add").text(e.target.value.match(/[^\\]+(?!.*\\)/)||"Please select a file")}),$("body").on("change","#dd-inputfile",function(e){$("#filename").text(e.target.value.match(/[^\\]+(?!.*\\)/)||"Please select a file")}),$("body").on("click","#dd-driven-add-modal",function(){i.fileNameAdd="",i.typeAdd="",i.currentAddressAdd="";var e=$("#dd-inputfile-add").parent("div");$("#dd-inputfile-add").remove(),$("#filebutton-add").remove(),$("#filename-add").remove(),e.append('<input id="dd-inputfile-add" type="file" name="file" style="display: none;"><input type="button" id="filebutton-add" value="Select JAR"><span id="filename-add">Please select a file</span>'),i.setAddressList(i.currentAddressAdd,"addtrue"),$("#data-driven-add").modal("show")}),$("body").on("click","#data-driven-menu li",function(){App.clearForm("datatable_update"),i.fileName="",i.type="",i.currentAddress="",i.driverId="";var e=$("#dd-inputfile").parent("div");$("#dd-inputfile").remove(),$("#filebutton").remove(),$("#filename").remove(),e.append('<input id="dd-inputfile" type="file" name="file" style="display: none;"><input type="button" id="filebutton" value="Select JAR"><span id="filename">Please select a file</span>');var d=$(this),a=d.find("strong").html();$(".r-container-header").find("h5").html(a),$(".r-container-header img").attr("src",d.find("img").attr("src")),$(this).addClass("click-add-background"),$(this).siblings().removeClass("click-add-background"),$.each(i.list,function(e,d){a==d.driverName&&($("#resourceType").val(d.databasetype),$("#driver_category").val(d.driver_category),$("#driven-datatable-view input[name=driver_name]").val(d.driverName),$("#driven-datatable-view input[name=class_name]").val(d.className),$("#driven-datatable-view input[name=url_info]").val(d.urlInfo),$("#driven-datatable-view input[name=db_port]").val(d.dbPort),$("#driven-datatable-view input[name=maxtime]").val(d.maxtime),i.driverId=d.driverId,i.currentAddress=d.address,i.setAddressList(d.address))})}),$("body").on("click","#driven_add_submit",function(){if($("#driven-Add-Form").validate().form()){if(!i.currentAddressAdd)return void toastr.info("Please upload a Jar file！");$("#data-driven-add").modal("hide");var e=App.getFormParams("driven-Add-Form");e.address=i.currentAddressAdd,App.blockUI({boxed:!0,message:"新增中..."}),i.addDrivenlist(e)}}),$("body").on("click","#data-driven-menu  li span",function(){var d={opType:"del"};d.driver_id=$(this).attr("driver_id"),bootbox.confirm("Please confirm to delete.",function(e){e&&(App.blockUI({boxed:!0,message:"Processing..."}),i.deleteDriven(d))})}),$("body").on("click","#dd-jaradd-btn-add",function(){$("#data-driven-add-file-add").modal("show")}),$("body").on("change","#dd-inputfile-add",function(e){i.fileNameAdd=e.currentTarget.files[0].name,i.typeAdd=i.fileNameAdd.substring(i.fileNameAdd.length-3,i.fileNameAdd.length)}),$("body").on("click","#dd-upfilejar-btn-add",function(){return i.typeAdd?"jar"!==i.typeAdd?(toastr.info("File type is incorrect, please upload a Jar file."),i.typeAdd="",$("#filename-add").text("Please select a file"),$("#dd-inputfile-add").val(""),!1):(App.blockUI({boxed:!0,message:"Uploading..."}),void i.upLoad(i.fileNameAdd,"addtrue")):(toastr.info("Please upload a Jar file！"),!1)}),$("body").on("click","#data_Table02_Detail .delete-jar",function(){var t=$(this);bootbox.confirm("Please confirm to delete.",function(e){if(e){var d=t.parent("td").data("index"),a=i.currentAddressAdd.split(",");a.splice(d-1,1),i.currentAddressAdd=a.join(","),i.setAddressList(i.currentAddressAdd,"addtrue")}})}),$("body").on("click","#dd-jaradd-btn",function(){$("#data-driven-add-file").modal("show")}),$("body").on("change","#dd-inputfile",function(e){i.fileName=e.currentTarget.files[0].name,i.type=i.fileName.substring(i.fileName.length-3,i.fileName.length)}),$("body").on("click","#dd-upfilejar-btn",function(){return i.type?"jar"!==i.type?(toastr.info("File type is incorrect, please upload a Jar file."),i.type="",$("#filename").text("Please select a file"),$("#dd-inputfile").val(""),!1):(App.blockUI({boxed:!0,message:"Uploading..."}),void i.upLoad(i.fileName)):(toastr.info("Please upload a Jar file！"),!1)}),$("body").on("click","#driven_Data_View_Detail .delete-jar",function(){var t=$(this);bootbox.confirm("Please confirm to delete.",function(e){if(e){var d=t.closest("td").data("index"),a=i.currentAddress.split(",");a.splice(d-1,1),i.currentAddress=a.join(","),i.setAddressList(i.currentAddress)}})}),$("body").on("click","#dd-update-button",function(e){if($("#driven-datatable-view").validate().form()){var d=App.getFormParams("datatable_update");if(d.address=i.currentAddress,!d.address)return void toastr.info("请添加jAR包");d.driver_id=i.driverId,i.updateDriven(d)}})}),module.exports=e});