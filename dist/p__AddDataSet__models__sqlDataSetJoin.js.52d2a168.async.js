(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{QaDJ:function(e,t,n){"use strict";var a=n("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("gWZ8")),r=a(n("p0pE")),u=a(n("Y/ft")),l=a(n("d6i3")),c=a(n("ywRk")),s=n("r1vm"),i=c.default.getMetadataColumnInfo,d=c.default.setDataColumnInfo,f={namespace:"sqlDataSetJoin",state:{tableJoin:[]},effects:{setDataColumnInfo:l.default.mark(function e(t,n){var a,o;return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.payload,o=n.call,n.put,e.next=4,o(d,{param:a});case 4:e.sent;case 5:case"end":return e.stop()}},e)}),echoJson:l.default.mark(function e(t,n){var a,o,r,u,c,s,d;return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.payload,o=n.call,r=n.put,u=n.all,c=a.json,e.next=5,u(c.tableList.map(function(e,t){return o(i,{param:{table_id:e.tableId}})}));case 5:return s=e.sent,s=s.map(function(e,t){return e.bcjson.items}),d=c.tableList.map(function(e,t){return{id:e.tableId,name:e.name,columnList:t>0?c.joinList[t-1].columnList:[],joinType:t>0?c.joinList[t-1].joinType:"",column:s[t],otherInfo:e.otherInfo}}),e.next=10,r({type:"changeTableJoin",payload:d});case 10:case"end":return e.stop()}},e)}),getMetadataColumnInfo:l.default.mark(function e(t,n){var a,c,d,f,p,m,b,y,w,h,j,J,v;return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.payload,c=n.call,d=n.put,f=n.select,e.next=4,f(function(e){var t=e.sqlDataSetJoin;return t.tableJoin});case 4:return p=e.sent,e.next=7,f(function(e){var t=e.sqlDataSetList;return t.connectionId});case 7:return m=e.sent,e.next=10,f(function(e){var t=e.sqlFilter;return t.targetObj});case 10:return b=e.sent,y=a.item,w=a.joinType,e.next=14,c(i,{param:{table_id:y.otherInfo.tableId}});case 14:if(h=e.sent,j=[],h&&"1"===h.bcjson.flag&&(j=h.bcjson.items),y.icon,J=(0,u.default)(y,["icon"]),0!==p.length){e.next=22;break}return v=(0,s.generateJson)([(0,r.default)({},J,{joinType:w,column:j})],b),e.next=22,d({type:"sqlKeydown/getMetadataTablePerform",payload:{connection_id:m,dataSetJson:JSON.stringify({jsonType:"SQL_BY_GRAPH",jsonContent:v}),opAction:"GRAPH2SQL"}});case 22:return e.next=24,d({type:"changeTableJoin",payload:[].concat((0,o.default)(p),[(0,r.default)({},J,{joinType:w,column:j})])});case 24:case"end":return e.stop()}},e)})},reducers:{changeTableJoin:function(e,t){return(0,r.default)({},e,{tableJoin:t.payload})}}};t.default=f}}]);