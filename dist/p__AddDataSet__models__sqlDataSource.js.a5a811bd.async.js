(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"6QOq":function(e,a,t){"use strict";var n=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=n(t("p0pE")),c=n(t("gWZ8")),o=n(t("d6i3"));t("miYZ");var u=n(t("tsqr")),s=n(t("Y/ft")),l=n(t("ywRk")),i=l.default.getDataSourceList,d=l.default.getTableData,f=l.default.getMetadataTablePerform,p={namespace:"sqlDataSource",state:{sqlDataSetName:"",activeKey:"",totalCount:0,metaDataTableList:[],dataSourceList:[],connectionId:"",tableData:[],column:[],defaultPageSize:5},effects:{getDataSourceList:o.default.mark(function e(a,t){var n,r,c,l,d,f;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.payload,r=t.call,c=t.put,l=n.connectionId,d=(0,s.default)(n,["connectionId"]),e.next=5,r(i,{param:d});case 5:if(f=e.sent,!f||"1"!==f.bcjson.flag){e.next=15;break}return e.next=9,c({type:"setDataSourceList",payload:f.bcjson.items});case 9:return e.next=11,c({type:"clear",payload:[]});case 11:return e.next=13,c({type:"getMetadataList",payload:{connection_id:l||f.bcjson.items[0]&&f.bcjson.items[0].connectionId,pageNumber:"1",pageSize:"30"}});case 13:e.next=16;break;case 15:u.default.error(f.bcjson.msg.substring(0,1e3));case 16:case"end":return e.stop()}},e)}),getMetadataList:o.default.mark(function e(a,t){var n,r,s,l,i,f;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.payload,r=t.call,s=t.put,l=t.select,e.next=4,l(function(e){var a=e.sqlDataSource;return a.metaDataTableList});case 4:return i=e.sent,e.next=7,r(d,{param:n});case 7:if(f=e.sent,!f||"1"!==f.bcjson.flag){e.next=13;break}return e.next=11,s({type:"setDataTableList",payload:{list:[].concat((0,c.default)(i),(0,c.default)(f.bcjson.items.map(function(e){return{id:e.tableId,name:"".concat(e.schemName,".").concat(e.tableName),icon:"iconbianjiqi_charubiaoge",otherInfo:e}}))),totalCount:f.bcjson.totalCount}});case 11:e.next=14;break;case 13:u.default.error(f.bcjson.msg.substring(0,1e3));case 14:case"end":return e.stop()}},e)}),getMetadataTablePerform:o.default.mark(function e(a,t){var n,r,c,u,s,l;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.payload,r=t.call,c=t.put,e.next=4,r(f,{param:n});case 4:if(u=e.sent,!u||"1"!==u.bcjson.flag){e.next=14;break}return s=u.bcjson.items[0]?u.bcjson.items[0]:{},l=Object.keys(s).map(function(e){return{value:e,type:isNaN(s[e])?"dimension":"measure",width:150}}),e.next=10,c({type:"changeColumn",payload:l});case 10:return e.next=12,c({type:"addMetadataTablePerform",payload:u.bcjson.items});case 12:e.next=16;break;case 14:return e.next=16,c({type:"addMetadataTablePerform",payload:[]});case 16:case"end":return e.stop()}},e)})},reducers:{changeActive:function(e,a){return(0,r.default)({},e,{activeKey:a.payload})},clear:function(e){return(0,r.default)({},e,{metaDataTableList:[]})},setDataTableList:function(e,a){var t=a.payload,n=t.list,c=t.totalCount;return(0,r.default)({},e,{metaDataTableList:n,totalCount:c})},setDataSourceList:function(e,a){return(0,r.default)({},e,{dataSourceList:a.payload})},saveConnectionId:function(e,a){return(0,r.default)({},e,{connectionId:a.payload.connectionId})},changeColumn:function(e,a){return(0,r.default)({},e,{column:a.payload})},addMetadataTablePerform:function(e,a){return(0,r.default)({},e,{tableData:a.payload})},clearMetadata:function(e){return(0,r.default)({},e,{tableData:[],column:[]})},changeDataSetName:function(e,a){return(0,r.default)({},e,{sqlDataSetName:a.payload})},changeDefaultPageSize:function(e,a){var t=a.payload;return(0,r.default)({},e,{defaultPageSize:t})}}};a.default=p}}]);