(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{dQiY:function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.getApprovalTaskList=p,t.getTaskDetail=o,t.claimTask=f,t.setTaskSave=v,t.default=void 0,a("miYZ");var s=r(a("tsqr")),n=r(a("d6i3")),u=r(a("p0pE")),c=r(a("1l/V")),l=a("jveU");function p(e){return i.apply(this,arguments)}function i(){return i=(0,c.default)(n.default.mark(function e(t){var a,r,s,u,c,p;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.page,r=void 0===a?1:a,s=t.pageSize,u=void 0===s?10:s,c=t.taskCode,p=t.type,e.abrupt("return",(0,l.request)("get_approval_task_list_page",{data:{pageNumber:r.toString(),pageSize:u.toString(),taskCode:c,type:p}}));case 2:case"end":return e.stop()}},e)})),i.apply(this,arguments)}function o(e){return d.apply(this,arguments)}function d(){return d=(0,c.default)(n.default.mark(function e(t){var a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.taskCode,e.abrupt("return",(0,l.request)("get_approval_task_detail",{data:{taskCode:a.toString()}}));case 2:case"end":return e.stop()}},e)})),d.apply(this,arguments)}function f(e){return k.apply(this,arguments)}function k(){return k=(0,c.default)(n.default.mark(function e(t){var a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.taskCode,e.abrupt("return",(0,l.request)("set_task_claim",{data:{taskCode:a.join(",")}}));case 2:case"end":return e.stop()}},e)})),k.apply(this,arguments)}function v(e){return w.apply(this,arguments)}function w(){return w=(0,c.default)(n.default.mark(function e(t){var a,r;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.taskCode,r=t.epCname,e.abrupt("return",(0,l.request)("set_approval_task_data_save",{data:{taskCode:a.join(","),epCname:r}}));case 2:case"end":return e.stop()}},e)})),w.apply(this,arguments)}var h={namespace:"approvalCenter",state:{tasks:[],alertItems:[],detailItems:{},total:0,alertOwner:""},reducers:{save:function(e,t){var a=t.payload,r=a.tasks,s=a.page,n=a.total;return(0,u.default)({},e,{tasks:r,page:s,total:n})},saveDetail:function(e,t){var a=t.payload,r=a.detailItems;return(0,u.default)({},e,{detailItems:r})}},effects:{fetch:n.default.mark(function e(t,a){var r,s,u,c,l,i,o,d,f,k,v,w;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,s=a.call,u=a.put,c=r||{},l=c.current,i=c.pageSize,o=c.taskCode,d=c.type,e.next=5,s(p,{current:l,pageSize:i,taskCode:o,type:d});case 5:if(f=e.sent,k=f.items,v=f.totalCount,w=f.err,!w){e.next=11;break}throw new Error(w);case 11:return e.next=13,u({type:"save",payload:{tasks:k,page:l,total:v}});case 13:case"end":return e.stop()}},e)}),fetchTaskDetail:n.default.mark(function e(t,a){var r,s,u,c,l,p,i,d;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,s=a.call,u=a.put,c=r||{},l=c.taskCode,e.next=5,s(o,{taskCode:l});case 5:if(p=e.sent,i=p.items,d=p.err,!d){e.next=10;break}throw new Error(d);case 10:return e.next=12,u({type:"saveDetail",payload:{detailItems:i}});case 12:case"end":return e.stop()}},e)}),claim:n.default.mark(function e(t,a){var r,u,c,l,p,i,o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,u=t.callback,c=a.call,l=r||[],p=l.taskCode,e.next=5,c(f,{taskCode:p});case 5:i=e.sent,o=i.err,o?s.default.success("claim failure"):(s.default.success("claim success"),u());case 8:case"end":return e.stop()}},e)}),saveTask:n.default.mark(function e(t,a){var r,u,c,l,p,i,o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,u=a.call,c=r||[],l=c.taskCode,p=c.epCname,e.next=5,u(v,{taskCode:l,epCname:p});case 5:i=e.sent,o=i.err,o?s.default.success("save failure"):s.default.success("save success");case 8:case"end":return e.stop()}},e)})}};t.default=h}}]);