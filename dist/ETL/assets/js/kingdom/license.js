define(function(require,exports,module){require("toastr"),$(function(){$("body").on("click","#j_btn_download_apply",function(t){t.preventDefault();$.kingdom.doKoauthAdminAPI("kingdom.krcs.get_auth_apply_file","v4.0",{},function(t){if(t&&t.bcjson&&t.bcjson.flag){var o=t.bcjson.items;if(o&&o[0]){var a=o[0].url;""!=$.trim(a)&&(window.location="/retl/rest/admin/klcs/file/download?fileUrl="+a)}}})}),window.upload_file_get_info=function(){$.kingdom.doKoauthAdminAPI("kingdom.krcs.get_auth_info","v4.0",{},function(t){if(t&&t.bcjson&&t.bcjson.flag){var o=t.bcjson.flag;if(o&&"1"==o){var a=t.bcjson.items[0];if(a){$("#j_active_date").val(a.active_date),$("#j_active_start_date").val(a.active_start_date),$("#j_active_start_end").val(a.active_start_end),$("#j_lcs_type").val(a.lcs_type),$("#j_valide_start_date").val(a.valide_start_date),$("#j_valide_start_end").val(a.valide_start_end);var n=a.license_control_param,i=$.parseJSON(n);i&&($("#j_org_count").val(i.org_count),$("#j_report_count").val(i.report_count),$("#j_biz_depart_count").val(i.biz_depart_count))}}}})},window.upload_file_get_info(),window.upload_file_cbfunc=function(t){if(t&&t.bcjson&&t.bcjson.items&&t.bcjson.items[0]){var o=t.bcjson.items[0];if(o){var a=o.fileUrl;if(""!=$.trim(a)){var n={};n.fileUrl=a,$.kingdom.doKoauthAdminAPI("kingdom.krcs.set_auth_file_parse","v4.0",n,function(t){t&&t.bcjson&&t.bcjson.flag&&("1"==t.bcjson.flag?window.upload_file_get_info():toastr.error(t.bcjson.msg,"",{positionClass:"toast-top-center"}))})}}}},$("#j_license_upload_input").change(function(e){var file=$(this).val();if(""!=$.trim(file)){var options={url:"/retl/rest/admin/klcs/file/upload",type:"POST",dataType:"json",success:function success(data){var jsondata={};jsondata="string"==typeof data?eval("("+data+")"):data,window.upload_file_cbfunc&&window.upload_file_cbfunc(jsondata)},error:function error(e){var jsondata={};jsondata="string"==typeof e.responseText?eval("("+e.responseText+")"):e,window.upload_file_cbfunc&&window.upload_file_cbfunc(jsondata)}};$("#j_license_upload_form").ajaxSubmit(options)}}),$("#j_btn_upload_auth_file").click(function(t){t.preventDefault(),$("#j_license_upload_input").trigger("click")}),$("body").on("click","#j_btn_download_auth_file",function(t){t.preventDefault();$.kingdom.doKoauthAdminAPI("kingdom.krcs.get_auth_file","v4.0",{},function(t){if(t&&t.bcjson&&t.bcjson.flag){var o=t.bcjson.items;if(o&&o[0]){var a=o[0].fileUrl;""!=$.trim(a)&&(window.location="/retl/rest/admin/klcs/file/download?fileUrl="+a)}}})})})});