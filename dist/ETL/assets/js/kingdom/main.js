var _extends=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i])}return a};define(function(require,exports,module){window.App=require("app");var a=require("./kweb");require("js/layouts/layout.min"),require("js/layouts/demo.min"),require("plugins/jquery-validation/js/jquery.validate"),require("plugins/jquery-validation/js/additional-methods.js"),require("plugins/jquery-validation/js/localization/messages_zh.min.js"),require("plugins/fullcalendar/fullcalendar"),require("plugins/fullcalendar/lib/moment.min"),require("plugins/fullcalendar/lang/zh-cn"),require("assets/plugins/colresizable/colResizable-1.6");var t=[],d=(a.kingdom.kconfig().theme,a.kingdom.kconfig().root);$.kingdom.kconfig().developer&&(console.log=function(){});function i(t,a){t=t||"index",history.pushState&&("common-page"==!t?history.pushState("","","index.html#"+t):"index"==t&&history.pushState("","","index.html")),$(".loading").remove(),$("#js_page_row,#index_page").hide(),$(".page-container").show();var i="",n="";if(-1<t.indexOf("common-page")&&!a){i="common-page";var e=t.substr(t.indexOf("?")+1,t.length);e=e.split("&");for(var o="{",s=0;s<e.length;s++){var l=e[s].split("=");"page"==l[0]?n=l[1]:o+='"'+l[0]+'":"'+l[1]+'",'}o=o.substr(0,o.length-1),o+="}",o=JSON.parse(o),$("#local-data").data("params",o)}else i=t.replace("#",""),n=a||i;var r=d+i+"/"+n;(new Date).getTime(),$.ajax({url:r+".html",dataType:"html",beforeSend:function(){App.blockUI({target:".page-content",overlayColor:"none",cenrerY:!0,animate:!0})},success:function(a){if(window.x_trace_page_id=$.kingdom.uuid(),null==a.match("<!DOCTYPE html>")){if(-1<t.indexOf("common-page"))$(".margin-top-20").fadeOut(),$("#js_page_common").html(a),$("#js_page_common").removeAttr("class").addClass("margin-top-20 page-"+i+" page-common-"+n),$("#js_page_common").fadeIn();else{if($("#js_page_common").hide(),$(".margin-top-20").hide(),$(".page-tabs-content a").removeClass("active"),0<$(".page-tabs-content a[data-titleId='"+i+"']").length)$(".page-tabs-content a[data-titleId='"+i+"']").addClass("active"),$("#"+i).show();else if("index"==t)$(".page-tabs-content a").eq(0).addClass("active"),$("#js_page_row").removeAttr("class").addClass("margin-top-20 page-"+i).html(a).show();else if(0===$(".page-tabs-content a[data-titleId='"+i+"']").length){var e=$("a[href=#"+t+"] span").html();"indexInformation"==t&&(e="信息统计"),$(".page-tabs-content").append('<a href="javascript:;" class="active J_menuTab" data-titleId="'+i+'">'+e+' <i class="fa fa-times-circle"></i></a>'),$(".page-content").append('<div id="'+i+'" class="margin-top-20 J_htmlTab page-'+i+'" style="display:none;"></div>'),$("#"+i).html(a).show()}p(),App.runResizeHandlers()}require.async(r+".js",function(a){a&&a.load&&(a.load(),g(".page-"+i),h(".page-"+i),$(".page-"+i+" .table").colResizable({liveDrag:!0,draggingClass:"dragging",resizeMode:"flex"}))}),c()}else toastr.info("请刷新当前页面重新登录。","登录失效！")},error:function(){var a='<div class="row"><div class="col-md-12 page-404"><div class="number font-red"> 404 </div><div class="details"><h3>啊唷，您要找的页面发生了意外。</h3><p>我们无法找到这个页面。<br/><p><a href="" class="btn red btn-outline"> 刷新试试 </a> 或<a href="index.html" class="btn red btn-outline"> 返回首页 </a><br> </p></div></div></div>';"common-page"==t?$("#js_page_common").removeAttr("class").addClass("margin-top-20 page-"+i).html(a).show():$("#js_page_row").removeAttr("class").addClass("margin-top-20 page-"+i).html(a).show()},complete:function(){App.unblockUI(".page-content")}})}function o(a){var e=$("li.nav-item"),t=($("li.nav-item a"),$("li.nav-item a[href=#"+a+"]"));(a||""==a)&&t&&t.length&&(e.removeClass("active open"),e.find(".arrow").removeClass("active open"),e.find(".selected").remove(),2==t.length?t.eq(1).parents(".nav-item").addClass("active open"):t.eq(0).parents(".nav-item").addClass("active open"),t.eq(0).parents(".nav-item").children(".nav-toggle").append("<span class='selected'></span>"),t.eq(0).parents(".nav-item").children(".nav-link").find(".arrow").addClass("open"))}var c=function(){$(".page-breadcrumb").empty(),$(".page-breadcrumb").append('<li><a href="index.html" style="color: #0C95E8;">主页</a></li>'),$(".active.open>a .title").each(function(a,e){t[a]=$(e).html(),$(".page-breadcrumb").append('<li><i class="fa fa-angle-right"></i><span></span></li>'),$(".page-breadcrumb li").eq(a+1).find("span").html($(e).html())})},p=function(){var a=navigator.userAgent.toLowerCase();if(-1<a.indexOf("ipad")||-1<a.indexOf("iphone")||-1<a.indexOf("android")||-1<a.indexOf("Android")||-1<a.indexOf("iPhone")){$("#head-navBtn").find("span").hide(),$("#head-navBtn").find("span").hide(),$(".tourist-wide a").each(function(){var a=$(this).find("i");$(this).html(a)})}else{var e;if(window.innerWidth?e=window.innerWidth:document.body&&document.body.clientWidth&&(e=document.body.clientWidth),e<800){$("#head-navBtn").find("span").hide();$(".tourist-wide a")}else $("#head-navBtn").find("span").show();$(window).resize(function(){$(this).width()<800?($("#head-navBtn").find("span").hide(),$("#head-navBtn").find("span").hide()):$("#head-navBtn").find("span").show()})}},g=function(a){if(0!==$(a+" .slide-toggle").length){$("body").width();var e=$(a+" .left-side").width(),t=($(".page-logo").outerWidth(),$(a+" .slide-toggle").position().left);$(a+" .right-content").css("width","calc(100% - "+(e+10)+"px)"),$(a+" .slide-toggle").click(function(){0<$(this).find(".fa-angle-left").length?($(this).siblings(".left-side").width(0),$(this).css({left:0}),$(this).siblings(".right-content").css("width","100%"),$(this).html('<i class="slide-icon fa fa-angle-right"></i>')):($(this).siblings(".left-side").width(e),$(this).css({left:t}),$(this).siblings(".right-content").css("width","calc(100% - "+(e+10)+"px)"),$(this).html('<i class="slide-icon fa fa-angle-left"></i>'))})}},h=function(a){if(0!==$(a+" .slide-toggle1").length){var e=$(a+" .left-side").width();$(a+" .right-content").css("width","calc(100% - "+(e+10)+"px)");var t=$(a+" .drag_bar").position().left;$(a).on("click",".slide-toggle1",function(){0<$(this).find(".fa-angle-left").length?($(".drag_bar").siblings(".left-side").width(0),$(".drag_bar").css({left:0}),$(".drag_bar").siblings(".right-content").css("width","100%"),$(this).html('<i class="slide-icon fa fa-angle-right"></i>'),$(this).css({left:0})):($(".drag_bar").siblings(".left-side").width(e),$(".drag_bar").css({left:t}),$(this).css("left",t-20),$(".drag_bar").siblings(".right-content").css("width","calc(100% - "+(e+10)+"px)"),$(this).html('<i class="slide-icon fa fa-angle-left"></i>'))})}};$(function(){var a=window.location.hash.substr(1).split("?")[0];function n(){$("#J_variable_num").text($("#J_variable_modal .variable-r .list-group-item:not('.first')").length)}i(a),$("body").on("click","[data-toggle=collapse].collapse-control",function(){0<$(this).find(".fa-sort-desc").length?$(this).html('<i class="fa fa-sort-asc"></i><span>'+$.i18n.map.Collapse+"</span>"):$(this).html('<i class="fa fa-sort-desc"></i><span>'+$.i18n.map["Search-More"]+"</span>")}),$("body").on("click","[data-toggle=collapse] span, [data-toggle=collapse] i",function(a){a.stopPropagation(),$(this).parent().click()}),$("body").on("click","[data-toggle='link']",function(){var a=$(this).attr("href").split("#")[1];if($("#local-data").data("params",$(this).data("params")),$("#local-data").data("source",$(this).data("source")),"common-page"==a){var e=$(this).data("linkto");return i(a,e),!1}}),$("body").on("click",".js-backtolist",function(){if(-1<location.href.indexOf("?page"))window.close();else{$("#js_page_common").fadeOut();var a=location.hash;$(a).fadeIn(),$(this).is("[refresh]")&&i($(".J_menuTab.active").data("titleid"))}}),window.util={},window.util.highlightNav=o,toastr.options.closeButton=!0,toastr.options.setTimeout="500",toastr.options.positionClass="toast-top-center",bootbox.setDefaults({title:"Tips"}),$("#js-logout1").click(function(){$(this);bootbox.confirm("确定退出当前系统吗？",function(a){a&&$.kingdom.logout(function(a){App.blockUI({boxed:!0,message:"正在退出"}),1==a.bcjson.flag?window.setTimeout(function(){App.unblockUI(),window.location.href="/login.html"},1e3):(App.unblockUI(),toastr.success(a.bcjson.msg))})})}),$(window).bind("hashchange",function(){var a=window.location.hash.substr(1);if("#report-table-info-manage"!==location.hash){var e=location.href.replace(location.search,"");window.location.href=e}-1<a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),i(a),o(a)}),$("body").on("click",".nav-link",function(){var a=$(this).attr("href"),e=location.hash===a;if(-1<a.indexOf("#")&&e){var t=a.replace("#","");i(t),o(t)}}),$("body").on("change",".date-picker,.date-time-picker,select[data-select2-id]",function(){0<$(this).closest("form").length&&$(this).closest("form").validate().element(this)}),$("body").on("click",".sidebar-toggler",function(){var a=".page-"+location.hash.substring("1"),e=($(a+" .right-content").width(),$(a+" .left-side").width());0<$(a+" .slide-toggle .fa-angle-left").length?$(a+" .right-content").css("width","calc(100% - "+(e+9)+"px)"):$(a+" .right-content").css("width","calc(100% - "+e+"px)"),$(this).hasClass("close-flag")?($(".page-sidebar-menu.page-sidebar-menu-hover-submenu>li:last > .sub-menu").css({bottom:"0"}),$(this).removeClass("close-flag")):($(".page-sidebar-menu.page-sidebar-menu-hover-submenu>li:last > .sub-menu").css({bottom:"auto"}),$(this).addClass("close-flag"))}),$("body").on("mouseover","#header_notification_bar",function(){$(this).addClass("open")}),$("body").on("mouseout","#header_notification_bar",function(){$(this).removeClass("open")}),$("body").on("click","[type=jstree], [type=treeselectchild], .jstree-ocl, .jstree-closed",function(a){a.stopPropagation()}),$("body").on("click","[type=jstree] .jstree-anchor",function(a){a.stopPropagation(),$(this).parents("[type=jstree]").siblings("input[type=hidden]").val($(this).parent().attr("folderid")),$(this).parents("[type=jstree]").siblings(".dropdown-toggle").val($(this).text()).attr("aria-expanded","false").parent().removeClass("open")}),$("body").on("click",".dropdown-toggle[name='folderName'][data-toggle=dropdown]+i",function(a){a.stopPropagation(),$(this).parent().toggleClass("open")}),$("body").on("click",".dropdown-toggle[name='jobName'][data-toggle=dropdown]+i",function(a){a.stopPropagation(),$(this).parent().toggleClass("open")}),$("body").on("click","tbody tr .bootstrap-switch-label",function(a){a.stopPropagation()}),$("body").on("click","#J_variable_search",function(){e()}),$("body").on("click","#J_variable_modal .variable-r .list-group-item .v-close",function(){var a=$(this).closest(".list-group-item").data("variablename");$("input[type=checkbox][data-variablename="+a+"]").prop("checked",!1),jQuery.uniform.update(),$(this).closest(".list-group-item").remove(),n()}),$("body").on("click","#J_variable_modal .variable-r .list-group-item .v-delete",function(){$("#J_variable_modal .variable-r .list-group-item:not('.first')").remove(),n(),$("#J_variable_table tbody tr input[type=checkbox]").prop("checked",!1),jQuery.uniform.update()}),$("body").on("change","#J_variable_table tbody tr td input[type=checkbox]",function(){var a=$(this).prop("checked"),e=$(this).data("variablename"),t=$("#J_variable_modal .variable-r .list-group-item:not('.first')");if(a)if(0===t.length)$("#J_variable_modal .variable-r .list-group").append('<li class="list-group-item" data-variablename="'+e+'"> \n                        <span>'+e+'</span> \n                        <a class="v-close" title="删除"> <i class="fa fa-close"></i> </a> \n                    </li>');else{var i=!1;$.each(t,function(){var a=$(this).data("variablename");e===a&&(i=!0)}),i||$("#J_variable_modal .variable-r .list-group").append('<li class="list-group-item" data-variablename="'+e+'"> \n                            <span>'+e+'</span> \n                            <a class="v-close" title="删除"> <i class="fa fa-close"></i> </a> \n                        </li>')}else $.each(t,function(){var a=$(this).data("variablename");e===a&&$(this).remove()});n()}),$("body").on("click",".set-variable",function(){$("#J_variable_modal .variable-r .list-group-item:not('.first')").remove();var a=$(this).prev(".form-control");a.val().match(/\$\{[\w+$]+\}/g);a.attr("modalTrigger","modalTrigger"),n(),e(),$("#J_variable_modal").modal("show")}),$("body").on("click","#J_choose_variable",function(){var a=$("#J_variable_modal .variable-r .list-group-item:not('.first')");0!==a.length?($.each(a,function(){var a=$(this).data("variablename"),e=$("[modalTrigger=modalTrigger]").val();$("[modalTrigger=modalTrigger]").val(e+"${"+a+"}")}),$("#J_variable_modal").modal("hide")):toastr.info("请选择变量")}),$("#J_variable_modal").on("hide.bs.modal",function(){$("[modalTrigger=modalTrigger]").removeAttr("modalTrigger")});var e=function a(e){var t={taskType:"TV"};t=_extends(t,e),$.kingdom.getList({apiName:"bayconnect.superlop.get_task_detail_info",apiVision:"v4.0",params:t,tableId:"J_variable_table",pageId:"J_variable_page",template:"common-template/variable-list.handlebars",formName:"J_variable_form",isGoPage:!1,cb:a},function(){var a=$("#J_variable_modal .variable-r .list-group-item:not('.first')");$.each(a,function(){var a=$(this).data("variablename");$("input[type=checkbox][data-variablename="+a+"]").prop("checked",!0)}),jQuery.uniform.update()})}})});