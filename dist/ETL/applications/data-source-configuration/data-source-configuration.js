var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};define(function(require,exports,module){var r=require("./data-source-configurationShow"),e={load:function(){r.load(),r.connect_id="",r.db_password="";var e=document.getElementById("J_drag_bar7"),t=document.getElementById("J_drag_bar7");startDrag(e,t,".left-side-source",".right-content-source",function(){LFWIDTH=$(".left-side").width()})}};$(function(){$("body").on("keydown","#data-source-configuration #J_dsc_list_search",function(e){13==e.keyCode&&$("#data-source-configuration #dsc-search").click()}),$("body").on("click","#data-source-configuration #dsc-search",function(){var e=$(this).siblings("input").val();r.get_source_connect_List(e)}),$("body").on("click","#data-source-configuration #data-source-configuration-reset",function(){$("#data-source-configuration-form #schemName").val(""),$("#data-source-configuration-form #tableName").val(""),$("#data-source-configuration-query").click()}),$("body").on("click","#data-source-configuration-query",function(){var e=App.getFormParams("data-source-configuration-form");e.connectionId=r.connect_id,-1<r.connection_type.indexOf("文件")?(r.hideShowBlock("#J_dsc_file_list_detail"),r.getExcelFileDetail(e)):(r.hideShowBlock("#J_dsc_list_detail"),r.qry_connect_data(e))}),$("body").on("click","#data-source-configuration .data-source-configuration-list li",function(){var e={pageNumber:"1"};$(this).addClass("click-add-background"),$(this).siblings().removeClass("click-add-background");var t=$(this).find("span a").data("params");r.connect_id=t.connect_id,r.connection_type=t.connection_type,$("#J_dsc_list_detail_title_type span").html(t.connection_name+"<span> / "+t.connection_type+"</span>"),r.getUser({connection_id:t.connect_id}),-1<t.connection_type.indexOf("文件")?(r.hideShowBlock("#J_dsc_file_list_detail"),r.getExcelFileDetail({connectionId:t.connect_id})):(r.hideShowBlock("#J_dsc_list_detail"),r.qry_connect_data(e))}),$("body").on("click","#data-source-configuration .winbd li",function(){"Excel"===$(this).find("a .txt").text()||"CSV"===$(this).find("a .txt").text()?(r.getConnectType($(this).find("a .txt").text()),r.clearFileBlock(),r.hideShowBlock("#J_dsc_fileType_add"),r.fileEdit=!1):(r.getConnectType($(this).find("a .txt").text()),r.hideShowBlock("#J_dsc_commonType_add")),$("#J_dsc_list_detail_title_type span").html("Create Data Source<span> / "+$(this).find("a .txt").text()+"</span>"),$("#data-connect-add-type button").click(),r.getDataSourceList(),$("#data-source-configuration [name=submitNum]").val("4096")}),$("body").on("blur","#data-connect-add-form input[name='principal']",function(){var e=$("#J_dsc_commonType_add input[name=jdbc_string]").val().split(";principal="),t="";t=2==e.length?e[0]:$("#J_dsc_commonType_add input[name=jdbc_string]").val(),""!=$(this).val()?$("#J_dsc_commonType_add input[name=jdbc_string]").val(t+";principal="+$(this).val()):$("#J_dsc_commonType_add input[name=jdbc_string]").val(t)}),$("body").on("click","#data-source-configuration #test-data-connect",function(){if(!$("#data-connect-add-form").validate().form())return!1;var e={};e.connection_name=$("#connection_name").val(),e.connection_desc=$("#data-connect-add-form input[name='connection_desc']").val(),e.connection_type=$("#connection_type").val(),e.server=$("#data-connect-add-form input[name='server']").val(),e.db_port=$("#data-connect-add-form input[name='db_port']").val(),e.db_database=$("#data-connect-add-form input[name='db_database']").val(),e.db_user=$("#data-connect-add-form input[name='db_user']").val();var t=$("#data-connect-add-form input[name='db_password']").val();e.db_password=$.des.getDes(t),e.jdbc_string=$("#data-connect-add-form input[name='jdbc_string']").val(),e.max_connect_count=$("#data-connect-add-form input[name='max_connect_count']").val(),e.driverInfo=$("#connection_type option:selected").attr("className"),App.blockUI({boxed:!0,message:"Testing..."}),r.testDataConnectList(e)}),$("body").on("click","#data-source-configuration #data-connect-add-submit",function(){if(!$("#data-connect-add-form").validate().form())return!1;var e={};e.connection_name=$("#connection_name").val(),e.connection_desc=$("#data-connect-add-form input[name='connection_desc']").val(),e.connection_type=$("#connection_type").val(),e.server=$("#data-connect-add-form input[name='server']").val(),e.db_port=$("#data-connect-add-form input[name='db_port']").val(),e.db_database=$("#data-connect-add-form input[name='db_database']").val(),e.db_user=$("#data-connect-add-form input[name='db_user']").val(),e.db_password=$.des.getDes($("#data-connect-add-form input[name='db_password']").val()),e.jdbc_string=$("#data-connect-add-form input[name='jdbc_string']").val(),e.max_connect_count=$("#data-connect-add-form input[name='max_connect_count']").val(),e.driverInfo=$("#connection_type option:selected").attr("className"),App.blockUI({boxed:!0,message:"Creating..."}),r.addDataConnectList(e)}),$("body").on("click","#data-source-configuration .data-source-configuration-list li a",function(e){e.stopPropagation(),$("#data-source-configuration .data-source-configuration-list li").removeClass("click-add-background"),$(this).closest("li").addClass("click-add-background");var t=$(this).data("params");if($("#J_dsc_list_detail_title_type span").html(t.connection_name+"<span> / "+t.connection_type+"</span>"),-1<t.connection_type.indexOf("文件"))return r.clearFileBlock(),r.hideShowBlock("#J_dsc_fileType_add"),r.getExcelFileTypeData({connectionId:t.connect_id}),!(r.fileEdit=!0);r.hideShowBlock("#J_dsc_commonType_edit"),"JTDS SQL Server"===t.connectionType?$("#data-connect-edit-form #db_password").attr("disabled","disabled"):$("#data-connect-edit-form #db_password").removeAttr("disabled"),r.getConnectType_edit(t.connection_type),console.log(r.list),r.connect_id=t.connect_id,r.db_password=t.db_password,$("#connection_type_edit").val(t.connection_type),$("#connection_name_edit").val(t.connection_name),$("#data-connect-edit-form input[name='connection_desc']").val(t.connection_desc),$("#data-connect-edit-form input[name='server']").val(t.server),$("#data-connect-edit-form input[name='db_port']").val(t.db_port),$("#data-connect-edit-form input[name='db_database']").val(t.db_database),$("#data-connect-edit-form input[name='db_user']").val(t.db_user),$("#data-connect-edit-form input[name='db_password']").val(t.db_password),$("#data-connect-edit-form input[name='jdbc_string']").val(t.jdbc_string),$("#data-connect-edit-form input[name='max_connect_count']").val(t.max_connect_count),t.db_password||$("#data-connect-edit-form input[name='db_database']").val("111111")}),$("body").on("click","#data-source-configuration #data-connect-edit-submit",function(){if(!$("#data-connect-edit-form").validate().form())return!1;var e={};e.connection_id=r.connect_id,e.connection_name=$("#connection_name_edit").val(),e.connection_desc=$("#data-connect-edit-form input[name='connection_desc']").val(),e.connection_type=$("#connection_type_edit").val(),e.server=$("#data-connect-edit-form input[name='server']").val(),e.db_port=$("#data-connect-edit-form input[name='db_port']").val(),e.db_database=$("#data-connect-edit-form input[name='db_database']").val(),e.db_user=$("#data-connect-edit-form input[name='db_user']").val(),e.jdbc_string=$("#data-connect-edit-form input[name='jdbc_string']").val(),e.max_connect_count=$("#data-connect-edit-form input[name='max_connect_count']").val(),e.driverInfo=$("#connection_type_edit option:selected").attr("className"),r.db_password&&r.db_password==$("#data-connect-edit-form input[name='db_password']").val()?e.db_password=r.db_password:e.db_password=$.des.getDes($("#data-connect-edit-form input[name='db_password']").val()),App.blockUI({boxed:!0,message:"modifying..."}),r.editDataConnectList(e)}),$("body").on("click","#data-source-configuration .data-source-configuration-list li .delBtn",function(){var t={};t.connection_id=$(this).attr("connection_id"),t.opType="del",t.driver_id=$(this).attr("driver_id"),bootbox.confirm("Please confirm to delete",function(e){e&&(App.blockUI({boxed:!0,message:"Processing..."}),r.deleteDataConnect(t))})}),$("body").on("click","#data-source-configuration #J_edit_test_submit",function(){if(!$("#data-connect-edit-form").validate().form())return!1;var e={};e.connection_name=$("#connection_name_edit").val(),e.connection_desc=$("#data-connect-edit-form input[name='connection_desc']").val(),e.connection_type=$("#connection_type_edit").val(),e.server=$("#data-connect-edit-form input[name='server']").val(),e.db_port=$("#data-connect-edit-form input[name='db_port']").val(),e.db_database=$("#data-connect-edit-form input[name='db_database']").val(),e.db_user=$("#data-connect-edit-form input[name='db_user']").val(),e.jdbc_string=$("#data-connect-edit-form input[name='jdbc_string']").val(),e.max_connect_count=$("#data-connect-edit-form input[name='max_connect_count']").val(),e.driverInfo=$("#connection_type_edit option:selected").attr("className"),r.db_password&&r.db_password==$("#data-connect-edit-form input[name='db_password']").val()?e.db_password=r.db_password:e.db_password=$.des.getDes($("#data-connect-edit-form input[name='db_password']").val()),App.blockUI({boxed:!0,message:"Testing..."}),r.testDataConnectList(e)}),$("body").on("click","#data-source-configuration #data_connect_import_btn",function(){$("#dsc-seach-metadata-input").val(""),$("#data_connect_import_modal").modal("show");var e=$(".data-source-configuration-list .click-add-background").attr("connection_id");App.blockUI({boxed:!0,message:"Search..."}),r.getImportDataSource(e)}),$("body").on("change","#data-source-configuration #data-connect-edit-form input[name='db_database']",function(){$("#data-connect-edit-form input[name='jdbc_string']").val()}),$("body").on("change","#data-source-configuration #connection_type",function(){var a,n=$(this).find("option:selected").attr("driverid");"JTDS SQL Server"===$(this).find("option:selected").attr("drivername")?($("#data-connect-add-form #db_password").attr("disabled","disabled"),$("#data-connect-add-form input[name='db_database']").val()||$("#data-connect-add-form input[name='db_database']").val("111111")):$("#data-connect-add-form #db_password").removeAttr("disabled"),$.each(r.getConnectTypeData,function(e,t){t.driverId===n&&($("#data-connect-add-form input[name='db_port']").val(t.dbPort),a=t.urlInfo)}),"CDH"==$(this).find("option:selected").html()?$("#data-connect-add-form input[name='principal']").closest(".form-group").removeClass("hide"):$("#data-connect-add-form input[name='principal']").closest(".form-group").addClass("hide");var e=$("#data-connect-add-form input[name='db_port']").val(),t=a;-1<t.indexOf("{host}:{port}")&&($("#data-connect-add-form input[name=jdbc_string]").val(t),t=t.replace("{port}",e)),$("#data-connect-add-form input[name=jdbc_string]").val(t),$("#J_dsc_list_detail_title_type span").html("Create Data Source<span> / "+$(this).find("option:selected").html()+"</span>"),$("#J_dsc_commonType_add input[name=jdbc_string]").attr("disabled","disabled"),$("#isUrlinfoDisable-add").closest("span").removeClass("checked"),-1<a.indexOf("{host}:{port}")||($("#J_dsc_commonType_add input[name=jdbc_string]").removeAttr("disabled"),$("#isUrlinfoDisable-add").closest("span").addClass("checked")),r.currentUrlInfo=a}),$("body").on("change","#data-source-configuration #connection_type_edit",function(){var e=$(this).find("option:selected").attr("urlinfo"),a=$(this).find("option:selected").attr("driverid");"JTDS SQL Server"===$(this).find("option:selected").attr("drivername")?($("#data-connect-edit-form #db_password").attr("disabled","disabled"),$("#data-connect-edit-form input[name='db_database']").val()||$("#data-connect-edit-form input[name='db_database']").val("111111")):$("#data-connect-edit-form #db_password").removeAttr("disabled"),$("#data-connect-edit-form input[name='jdbc_string']").val(e),$.each(r.getConnectTypeData,function(e,t){t.driverId===a&&$("#data-connect-edit-form input[name='db_port']").val(t.dbPort)}),$("#data-connect-edit-form input[name='jdbc_string']").attr("disabled","disabled"),$("#isUrlinfoDisable-edit").closest("span").removeClass("checked");var t=$("#data-connect-edit-form input[name='jdbc_string']").val();if(-1<t.indexOf("{host}:{port}")){var n=$("#data-connect-edit-form input[name='server']").val(),o=$("#data-connect-edit-form input[name='db_port']").val(),c=$("#data-connect-edit-form input[name='db_database']").val();n&&(t=t.replace("{host}",n)),o&&(t=t.replace("{port}",o)),c&&(t=t.replace("{database}",c)),$("#data-connect-edit-form input[name='jdbc_string']").val(t)}else $("#data-connect-edit-form input[name=jdbc_string]").removeAttr("disabled"),$("#isUrlinfoDisable-edit").closest("span").addClass("checked")}),$("body").on("change","#data-source-configuration #isUrlinfoDisable-add",function(){"checked"===$("#isUrlinfoDisable-add").closest("span").attr("class")?$("#J_dsc_commonType_add input[name=jdbc_string]").removeAttr("disabled"):$("#J_dsc_commonType_add input[name=jdbc_string]").attr("disabled","disabled")}),$("body").on("change","#data-source-configuration #isUrlinfoDisable-edit",function(){"checked"===$("#isUrlinfoDisable-edit").closest("span").attr("class")?$("#data-connect-edit-form input[name=jdbc_string]").removeAttr("disabled"):$("#data-connect-edit-form input[name=jdbc_string]").attr("disabled","disabled")}),$("body").on("blur","#data-source-configuration #data-connect-add-form input[name='server'],#data-connect-add-form input[name='db_port'],#data-connect-add-form input[name='db_database']",function(){var e=r.currentUrlInfo;if(!(-1<e.indexOf("{host}:{port}")))return!1;var t=$("#data-connect-add-form input[name='server']").val(),a=$("#data-connect-add-form input[name='db_port']").val(),n=$("#data-connect-add-form input[name='db_database']").val();t&&(e=e.replace("{host}",t)),a&&(e=e.replace("{port}",a)),n&&(e=e.replace("{database}",n));var o=$("#J_dsc_commonType_add input[name=principal]").val();""!=o?$("#J_dsc_commonType_add input[name=jdbc_string]").val(e+";principal="+o):$("#J_dsc_commonType_add input[name=jdbc_string]").val(e)}),$("body").on("blur","#data-source-configuration #data-connect-edit-form input[name='server'],#data-source-configuration #data-connect-edit-form input[name='db_port'],#data-source-configuration #data-connect-edit-form input[name='db_database']",function(){var e=$("#connection_type_edit").find("option:selected").attr("urlinfo");if(!(-1<e.indexOf("{host}:{port}")))return!1;var t=$("#data-connect-edit-form input[name='server']").val(),a=$("#data-connect-edit-form input[name='db_port']").val(),n=$("#data-connect-edit-form input[name='db_database']").val();t&&(e=e.replace("{host}",t)),a&&(e=e.replace("{port}",a)),n&&(e=e.replace("{database}",n)),$("#data-connect-edit-form input[name='jdbc_string']").val(e)}),$("body").on("click","#data-source-configuration #import_submit",function(){var e=$.kingdom.uniqueArray($("#J_tree_import").jstree("get_checked"));$.each(e,function(e,t){-1===t.indexOf("child")&&0===$("#"+t+" > ul").length&&($("#"+t+" > i").click(),$("#"+t+" > ul").addClass("jstree-hide"))}),r.saveTableList()}),$("body").on("click","#data-source-configuration #dsc-delete-table",function(){if(0===$("#J_data_connect_table .checked").length)return toastr.info("Please select the object"),!1;bootbox.confirm("Please confirm to delete",function(e){e&&(App.blockUI({boxed:!0,message:"Processing..."}),r.deleteTableList())})}),$("body").on("click","#data-source-configuration #dsc-tables-upd",function(){if(0===$("#J_data_connect_table .checked").length)return toastr.info("Please select the object"),!1;bootbox.confirm("Please confirm to update field.",function(e){e&&(App.blockUI({boxed:!0,message:"updating..."}),r.metadataTablesUpd())})}),$("body").on("click","#data-source-configuration #dsc-table_recordcount_upd",function(){if(0===$("#J_data_connect_table .checked").length)return toastr.info("Please select the object"),!1;bootbox.confirm("Please confirm to update row number.",function(e){e&&(App.blockUI({boxed:!0,message:"updating..."}),r.tableRecordcountUpd())})}),$("body").on("click","#data-source-configuration #dsc-tables-upd-batch",function(){bootbox.confirm("Please confirm to batch update field.",function(e){if(e){App.blockUI({boxed:!0,message:"updating..."});var t=$(".data-source-configuration-list .click-add-background").attr("connection_id");r.metadataTablesUpdBatch({allCheckFlag:"Y",connection_id:t})}})}),$("body").on("click","#data-source-configuration #dsc-table_recordcount_upd_batch",function(){bootbox.confirm("Please confirm to batch update row number.",function(e){if(e){App.blockUI({boxed:!0,message:"updating..."});var t=$(".data-source-configuration-list .click-add-background").attr("connection_id");r.tableRecordcountUpdBatch({allCheckFlag:"Y",connection_id:t})}})}),$("body").on("click","#J_list_export",function(){r.listImport({connection_id:r.connect_id,tableId:""}).then(function(e){return r.listImport2({fileClass:e.bcjson.items[0].fileClass,filePath:e.bcjson.items[0].filePath}).then(function(e){return r.listImport3({fileClass:"ZIP",downloadToken:e.bcjson.items[0].downloadToken,_s_t_i_0000:$.kingdom.getValue("x-trace-user-id")})})})}),$("body").on("click","#data-source-configuration #dsc-modal-check",function(){$("#des-table-info-modal").modal("show"),$("#des-table-info-modal ul li a:eq(0)").click(),$("#des-table-info-modal #des-showtable-info-1-form input[name='tableName']").val($(this).closest("td").data("tablename")),$("#des-table-info-modal #des-showtable-info-1-form input[name='tableCat']").val($(this).closest("td").data("tablecat")),$("#des-table-info-modal #des-showtable-info-1-form input[name='mdType']").val($(this).closest("td").data("mdtype")),$("#des-table-info-modal #des-showtable-info-1-form input[name='tableDesc']").val($(this).closest("td").data("tabledesc")),$("#des-table-info-modal #des-showtable-info-1-form input[name='schemName']").val($(this).closest("td").data("schemname")),r.getTabColumnInfo($(this).closest("td").data("tableid")),$("#des-showtable-info-3-button").attr("tablename",$(this).closest("td").data("tablename")),$("#des-showtable-info-3-button").attr("schemname",$(this).closest("td").data("schemname")),$("#des-showtable-info-3-table-body").html(""),$("#des-showtable-info-3-thead-tr").html(""),$("#des-showtable-info-3-table").siblings("img").remove(),$("#des-showtable-info-3-button").click()}),$("body").on("click","#data-source-configuration #dsc-modal-delete",function(){var t=$(this).closest("td").data("tableid");bootbox.confirm("Please confirm to delete",function(e){e&&(App.blockUI({boxed:!0,message:"Processing..."}),r.deleteTableList(!0,t))})}),$("body").on("click","#data-source-configuration #des-showtable-info-3-button",function(){var e=$(this).attr("tablename"),t=$(this).attr("schemname");r.previewAction(t,e)}),$("body").on("keydown","#data-source-configuration #dsc-seach-metadata-input",function(e){13==e.keyCode&&$("#data-source-configuration #dsc-seach-metadata").click()}),$("body").on("click","#data-source-configuration #dsc-seach-metadata",function(){var o=$("#data-source-configuration #dsc-seach-metadata-input").val().toUpperCase(),c=[];$.each(r.getCurrentTreeData,function(e,t){var a=$.extend({},t),n=[];$.each(a.tableList,function(e,t){n.push(t)}),a.tableList=n,c.push(a)}),$.each(c,function(e,t){for(var a=0,n=t.tableList.length;a<n;a++)t.tableList[a]&&t.tableList[a].tableName.toUpperCase().indexOf(o)<=-1&&t.tableList.splice(a--,1);t.tableCounts=t.tableList.length.toString()}),r.generateTree(c,!0)}),$("body").on("click","#data-source-configuration #J_dsc_add_file",function(){$("#J_mock_form_collection input[type=file]").click()}),$("body").on("change","#data-source-configuration #J_mock_form_collection_form input[name='file']",function(e){var t=e.currentTarget.files[0].name.split("."),a=t[t.length-1];"xls"===a||"xlsx"===a?(App.blockUI({boxed:!0,message:"Uploading..."}),r.upLoad(e.currentTarget.files[0].name,a)):toastr.info("XLS file or XLSW file only")}),$("body").on("click","#data-source-configuration .excel-choose-block-inside ul li .glyphicon-trash",function(){$("#J_mock_form_collection_form input[name='file']").val(""),$(this).closest("li").remove(),$("#data-source-configuration .excel-bottom span span").html($("#data-source-configuration .excel-choose-block-inside ul li").length),$("#J_dsc_produce_head").html(""),$("#J_dsc_produce_body").html(""),$("#J_dsc_produce_head_option").html(""),$("#J_dsc_produce_body_option").html(""),$("#J_dsc_produce_head").closest(".table-scrollable").toggleClass("hide"),r.getExcelContentList()}),$("body").on("click","#data-source-configuration #J_dsc_clear_file",function(){$("#J_mock_form_collection_form input[name='file']").val(""),$("#data-source-configuration .excel-choose-block-inside ul li").remove(),$("#data-source-configuration .excel-bottom span span").html("0"),$("#J_dsc_produce_head").html(""),$("#J_dsc_produce_body").html(""),$("#J_dsc_produce_head_option").html(""),$("#J_dsc_produce_body_option").html(""),$("#J_dsc_produce_head").closest(".table-scrollable").addClass("hide"),r.getExcelContentList()}),$("body").on("change","#J_select2_dcs_target_data_connect",function(e){r.getTableList({connection_id:e.currentTarget.value},"#J_select2_des_target_object",!1,function(){if(r.targetTable){var e=$("#J_select2_des_target_object").data("origin"),t=!0,a=!1,n=void 0;try{for(var o,c=e[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var d=o.value,i=d.id;d.text===r.targetTable&&$("#J_select2_des_target_object").val(i).change()}}catch(e){a=!0,n=e}finally{try{!t&&c.return&&c.return()}finally{if(a)throw n}}}else $("#J_select2_des_target_object").change();r.targetTable=""})}),$("body").on("click","#data-source-configuration [name=dataTimeType]",function(){var e=$(this).val(),t={rtl:!1,orientation:"left",todayBtn:"linked",autoclose:!0,language:"zh-CN",todayHighlight:!0,startView:2,maxViewMode:2,minViewMode:2,format:"yyyy"};"0"==e?(t.startView=0,t.maxViewMode=0,t.minViewMode=0,t.format="yyyymmdd"):"1"==e?(t.startView=1,t.maxViewMode=1,t.minViewMode=1,t.format="yyyymm"):(t.startView=2,t.maxViewMode=2,t.minViewMode=2,t.format="yyyy",$(this).val(e.substring(0,4))),jQuery().datepicker&&($("[name=dataTime]").datepicker("remove"),$("[name=dataTime]").datepicker(t),$("[name=dataTime]").datepicker("setDate",new Date))}),$("body").on("click","#data-source-configuration #J_excel_add_tab3_btn [data-type]",function(){var e=$(this).data("type"),t=$("#J_excel_add_tab2_form select[name='targetTable']").val();"refresh"===e?r.getDataField_2({table_id:t}):"del"===e&&r.haddleDataField_2.delCheckedRow()}),$("body").on("change","#J_excel_add_tab1 input[name=headType]",function(){"0"===$(this).val()?($("#J_dsc_produce_table").removeClass("hide"),$("#J_dsc_produce_table_option").addClass("hide")):($("#J_dsc_produce_table").addClass("hide"),$("#J_dsc_produce_table_option").removeClass("hide"))}),$("body").on("click","#data-source-configuration #J_dsc_pre_step",function(){var e=$("#J_dsc_fileType_add li").index($("#J_dsc_fileType_add li.active"));if(0===e)return!1;1===e?($("#data-source-configuration #J_dsc_fileType_add .tabbable-line li").removeClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li:eq(0)").addClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tab-pane").removeClass("active"),$("#data-source-configuration #J_excel_add_tab1").addClass("active")):2===e&&($("#data-source-configuration #J_dsc_fileType_add .tabbable-line li").removeClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li:eq(1)").addClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tab-pane").removeClass("active"),$("#data-source-configuration #J_excel_add_tab2").addClass("active"))}),$("body").on("click","#data-source-configuration #J_dsc_next_step",function(){var e=$("#J_dsc_fileType_add li").index($("#J_dsc_fileType_add li.active")),t={},a=$("#data-source-configuration #J_excel_add_tab1 input[name='connectionName']").val();t.connectionName=a;var n=$("#data-source-configuration #J_excel_add_tab1 .excel-choose-block-inside li:eq(0) span"),o=n.html(),c=n.attr("fileurl"),d=n.attr("type");t.fileName=o,t.fileUrl=c,t.fileType=d;var i="",s=$("#J_excel_add_tab1 input[name=headType]:checked").val();if(i="0"===s?"0":($.each($("#J_dsc_produce_table_option input[type=checkbox]:checked"),function(){i=i+$("#J_dsc_produce_table_option input[type=checkbox]").index($(this))+","}),i.substring(0,i.length-1)),t=_extends(t,App.getFormParams("J_excel_add_tab2_form")),$("#J_excel_add_tab2_form select[name='targetTable']").val()&&(t.targetTable=$("#J_excel_add_tab2_form select[name='targetTable']").select2("data")[0].text.replace("(表)","")),t.mappingInfo=r.haddleDataField_2.getData(),0===e){if(!a)return toastr.info("Source Name is missing!"),!1;if(0===$("#data-source-configuration #J_excel_add_tab1 .excel-choose-block-inside li").length)return toastr.info("Please upload a file"),!1;$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li").removeClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li:eq(1)").addClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tab-pane").removeClass("active"),$("#data-source-configuration #J_excel_add_tab2").addClass("active")}else 1===e?(r.getDataField_2({table_id:$("#J_excel_add_tab2_form select[name='targetTable']").val()}),$("#data-source-configuration a[href='#J_excel_add_tab3']").click(),$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li").removeClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tabbable-line li:eq(2)").addClass("active"),$("#data-source-configuration #J_dsc_fileType_add .tab-pane").removeClass("active"),$("#data-source-configuration #J_excel_add_tab3").addClass("active")):2===e&&(t.DBTYPE="FILE",t.connectionType=$("#connection_type").val(),t.headLine=i,r.fileEdit&&(t.opType="UPD",t.connectionId=$("#data-source-configuration .data-source-configuration-list .click-add-background").attr("connection_id")),r.addDataConnectList(t))}),$("body").on("click","#data-source-configuration #J_file_data_result_body #dsc-modal-check-file",function(){var e=$(this).closest("td"),t={connectionId:e.attr("connectionid"),fileUrl:e.attr("fileurl"),fileType:e.attr("filetype"),fileName:e.attr("filename")};r.hideShowBlock("#J_dsc_file_list_single_detail"),$("#data-source-configuration #J_dsc_back_to_list").removeClass("hide"),r.getExcelSingleFileDetail(t)}),$("body").on("click","#data-source-configuration #J_single_file_data_result_body a",function(){var o=$(this).closest("tr").find("td");if("编辑"===$(this).html())$.each(o,function(e,t){if(e!==o.length-1){var a=$(t).html(),n=$(t).width();$(t).html("<input type='text' style='width:"+n+"px'/>"),$(t).find("input").val(a)}else $(t).html("<a href='javascript:;'>SAVE</a>")});else{var n=JSON.parse($(this).closest("tr").attr("currentdata")),e=$(this).closest("tr").find("input"),c=[];$.each(e,function(e,t){var a={};c.push(a),a.key=$(t).closest("td").attr("currentkey"),a.val=$(t).val(),$(t).val()===n[a.key]?a.isTrans=0:a.isTrans=1}),App.blockUI({boxed:!0,message:"Saving..."});var t=JSON.parse($(this).closest("table").find("thead tr").attr("currentpreparams"));t.dataInfo=c,r.editExcelSingleFileDetail(t)}}),$("body").on("click","#data-source-configuration #J_dsc_back_to_list",function(){r.hideShowBlock("#J_dsc_file_list_detail")})}),module.exports=e});