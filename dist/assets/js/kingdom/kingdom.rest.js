var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};if("undefined"==typeof jQuery)throw new Error("kingdom.rest requires jQuery");var kingdom=kingdom||{};kingdom.rest=kingdom.rest||{},kingdom.rest.config=kingdom.rest.config||{},kingdom.rest.util=kingdom.rest.util||{},kingdom.rest.config.theme="retl",kingdom.rest.config.root="/applications/"+kingdom.rest.config.theme+"/",kingdom.rest.config.fileserver="/fileserver",kingdom.rest.config.developer=!1,kingdom.rest.util.log=function(a){$.kingdom.logShow&&console&&console.log&&console.log(a)},kingdom.rest.util.uuid=function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},kingdom.rest.util.dateFormat=function(a){var e=new Date,t={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return a},kingdom.rest.api=function(api_name,api_version,api_params,cbfunc,method){$.kingdom.log("\n\n\n======"+$.kingdom.dateFormat("yyyy-MM-dd hh:mm:ss")+"\t"+document.location.href+"\n======begin call api:"+api_name+" ,version:"+api_version),$.kingdom.log("======api params:"+JSON.stringify(api_params||{}));var $this=this,param=$.kingdom.getAjaxParams(api_name,api_version,api_params),dataLen=JSON.stringify(param),url="/admin_api";url="/retl/rest/common/admin/"+$.trim(api_version)+"/"+$.trim(api_name)+".json";var type="get";type=dataLen&&2048<dataLen.length?"post":method,$.ajax({type:type,url:url,dataType:"json",data:param,timeout:12e4,async:!0,beforeSend:function(a){var e=$.cookie("x-trace-user-id");""==$.trim(e)&&(e=$.kingdom.uuid(),$.cookie("x-trace-user-id",e));var t=window.x_trace_page_id;""==$.trim(t)&&(t=$.kingdom.uuid(),window.x_trace_page_id=t),a.setRequestHeader("X-Kweb-Menu-Id",document.location.href),a.setRequestHeader("X-Kweb-Trace-Req-Id",$.kingdom.uuid()),a.setRequestHeader("X-Kweb-Trace-Page-Id",t),a.setRequestHeader("X-Kweb-Trace-User-Id",e),a.setRequestHeader("X-Kweb-Location-Href",document.location.href),a.setRequestHeader("X-Kweb-Timestamp",(new Date).getTime()+""),a.setRequestHeader("X-Kweb-Sign",$.md5(document.location.href)),a.setRequestHeader("X-Kweb-Api-Name",$.trim(api_name)),a.setRequestHeader("X-Kweb-Api-Version",$.trim(api_version))}}).done(function(data){if($.kingdom.log("======api return result:"+JSON.stringify(data||{})),data&&data.bcjson&&data.bcjson.flag){var flag=data.bcjson.flag;"0"==flag&&console}if("object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&data){if(!data.bcjson)return!1;var flag=data.bcjson.flag;if("0"==flag&&"入参检查失败， [employeeId] 不能为空"==data.bcjson.msg)return $this.logout(function(){document.location.href="/login.html"}),!1;var _exception=!1;if(data.bcjson.exception&&(_exception=!0),""!=data.bcjson.exception&&_exception&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").show(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html(data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API："+api_name+",<br />入参：";return $("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")),$("#message_info_all_params_4").html(data.bcjson.exception.replace(/at /g," <br /> at ").replace(/,/g,",<br />")),$("#message_info_all_params").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_content").html(data.bcjson.msg),!1}if("0"==data.bcjson.flag&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").hide(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html("调试跟踪:"+data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API： "+api_name+",<br />入参：";return data.bcjson.reqParam&&$("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),data.bcjson.currentParam?$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")):$("#message_info_all_params_3").html(""),cbfunc(data),!1}cbfunc(data)}})},$.extend({kingdom_temp:{kconfig:function(){var a="retl";return{theme:a,root:"/applications/retl/",fileserver:"/fileserver",developer:!1}},testMode:!0,logShow:!1,tempParams:{},log:function(a){$.kingdom.logShow&&console&&console.log&&console.log(a)},getBrowser:function(a){var e,t,n,o,r,i,s=navigator.userAgent.toLowerCase();return r="ActiveXObject"in self?(o=(n=s.match(/msie ([\d.]+)/))?n[1]:(n=s.match(/rv:([\d.]+)/))?n[1]:0,0<((e={"trident/7.0":11,"trident/6.0":10,"trident/5.0":9,"trident/4.0":8})[t=(n=s.match(/(trident\/[\d.]+|edge\/[\d.]+)/))?n[1]:void 0]||o)?"ie":void 0):(n=s.match(/edge\/([\d.]+)/))?"edge":(n=s.match(/firefox\/([\d.]+)/))?"firefox":(n=s.match(/chrome\/([\d.]+)/))?"chrome":(n=s.match(/opera.([\d.]+)/))?"opera":(n=s.match(/version\/([\d.]+).*safari/))?"safari":void 0,i=t&&e[t]?e[t]:n[1],null!=a?r+"/"+i:r},recommendBrowser:function(){var a=this.getBrowser(!0);(-1<a.indexOf("ie/")||-1<a.indexOf("edge/"))&&toastr.info("Google browser recommended^_^",{positionClass:"toast-top-right"})},uuid:function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},dateFormat:function(a){var e=new Date,t={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return a},doKoauthAPI:function(a,e,t,n){var o=this,r=$.kingdom.getAjaxParams(a,e,t);$.post("/api",r,function(a){if(n){var e=a.bcjson.flag;if("0"!=e&&"1"!=e)return o.logout(function(){document.location.href="/login.html"}),!1;n(a)}},"json")},doKoauthAdminAPI:function doKoauthAdminAPI(api_name,api_version,api_params,cbfunc,method){$.kingdom.log("\n\n\n======"+$.kingdom.dateFormat("yyyy-MM-dd hh:mm:ss")+"\t"+document.location.href+"\n======begin call api:"+api_name+" ,version:"+api_version),$.kingdom.log("======api params:"+JSON.stringify(api_params||{}));var $this=this,param=$.kingdom.getAjaxParams(api_name,api_version,api_params),dataLen=JSON.stringify(param),url="/admin_api";url="/retl/rest/admin/"+$.trim(api_version)+"/"+$.trim(api_name)+".json";var type="get";type=dataLen&&2048<dataLen.length?"post":method,$.ajax({type:type,url:url,dataType:"json",data:param,timeout:12e4,async:!0,beforeSend:function(a){var e=$.cookie("x-trace-user-id");""==$.trim(e)&&(e=$.kingdom.uuid(),$.cookie("x-trace-user-id",e));var t=window.x_trace_page_id;""==$.trim(t)&&(t=$.kingdom.uuid(),window.x_trace_page_id=t),a.setRequestHeader("X-Kweb-Menu-Id",document.location.href),a.setRequestHeader("X-Kweb-Trace-Req-Id",$.kingdom.uuid()),a.setRequestHeader("X-Kweb-Trace-Page-Id",t),a.setRequestHeader("X-Kweb-Trace-User-Id",e),a.setRequestHeader("X-Kweb-Location-Href",document.location.href),a.setRequestHeader("X-Kweb-Timestamp",(new Date).getTime()+""),a.setRequestHeader("X-Kweb-Sign",$.md5(document.location.href)),a.setRequestHeader("X-Kweb-Api-Name",$.trim(api_name)),a.setRequestHeader("X-Kweb-Api-Version",$.trim(api_version))}}).done(function(data){if($.kingdom.log("======api return result:"+JSON.stringify(data||{})),data&&data.bcjson&&data.bcjson.flag){var flag=data.bcjson.flag;"0"==flag&&console}if("object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&data){if(!data.bcjson)return!1;var flag=data.bcjson.flag;if("0"==flag&&"入参检查失败， [employeeId] 不能为空"==data.bcjson.msg)return $this.logout(function(){document.location.href="/login.html"}),!1;var _exception=!1;if(data.bcjson.exception&&(_exception=!0),""!=data.bcjson.exception&&_exception&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").show(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html(data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API："+api_name+",<br />入参：";return $("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")),$("#message_info_all_params_4").html(data.bcjson.exception.replace(/at /g," <br /> at ").replace(/,/g,",<br />")),$("#message_info_all_params").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_content").html(data.bcjson.msg),!1}if("0"==data.bcjson.flag&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").hide(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html("调试跟踪:"+data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API： "+api_name+",<br />入参：";return data.bcjson.reqParam&&$("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),data.bcjson.currentParam?$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")):$("#message_info_all_params_3").html(""),cbfunc(data),!1}cbfunc(data)}})},doKoauthAdminAPISync:function doKoauthAdminAPISync(api_name,api_version,api_params,cbfunc,method){$.kingdom.log("\n\n\n======"+$.kingdom.dateFormat("yyyy-MM-dd hh:mm:ss")+"\t"+document.location.href+"\n======begin call api:"+api_name+" ,version:"+api_version),$.kingdom.log("======api params:"+JSON.stringify(api_params||{}));var $this=this,param=$.kingdom.getAjaxParams(api_name,api_version,api_params),url="/admin_api";url="/retl/rest/admin/"+$.trim(api_version)+"/"+$.trim(api_name)+".json";var type=method||"get",dataLen=JSON.stringify(param);dataLen&&2048<dataLen.length&&(type="post"),$.ajax({type:type,url:url,dataType:"json",data:param,timeout:12e4,async:!1,beforeSend:function(a){var e=$.cookie("x-trace-user-id");""==$.trim(e)&&(e=$.kingdom.uuid(),$.cookie("x-trace-user-id",e));var t=window.x_trace_page_id;""==$.trim(t)&&(t=$.kingdom.uuid(),window.x_trace_page_id=t),a.setRequestHeader("X-Kweb-Menu-Id",document.location.href),a.setRequestHeader("X-Kweb-Trace-Req-Id",$.kingdom.uuid()),a.setRequestHeader("X-Kweb-Trace-Page-Id",t),a.setRequestHeader("X-Kweb-Trace-User-Id",e),a.setRequestHeader("X-Kweb-Location-Href",document.location.href),a.setRequestHeader("X-Kweb-Timestamp",(new Date).getTime()+""),a.setRequestHeader("X-Kweb-Sign",$.md5(document.location.href)),a.setRequestHeader("X-Kweb-Api-Name",$.trim(api_name)),a.setRequestHeader("X-Kweb-Api-Version",$.trim(api_version))}}).done(function(data){if($.kingdom.log("======api return result:"+JSON.stringify(data||{})),data&&data.bcjson&&data.bcjson.flag){var flag=data.bcjson.flag;"0"==flag&&console}if("object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&data){if(!data.bcjson)return!1;var flag=data.bcjson.flag;if("0"==flag&&"入参检查失败， [employeeId] 不能为空"==data.bcjson.msg)return $this.logout(function(){document.location.href="/login.html"}),!1;var _exception=!1;if(data.bcjson.exception&&(_exception=!0),""!=data.bcjson.exception&&_exception&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").show(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html(data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API："+api_name+",<br />入参：";return $("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")),$("#message_info_all_params_4").html(data.bcjson.exception.replace(/at /g," <br /> at ").replace(/,/g,",<br />")),$("#message_info_all_params").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),$("#message_info_all_content").html(data.bcjson.msg),!1}if("0"==data.bcjson.flag&&1==$.kingdom.logShow){$(".bootbox-confirm").hide(),$(".modal-backdrop").hide(),App.unblockUI(),$(".exceptionLocation").hide(),$("#message_info_all").modal("show"),$("#message_info_all_params_1").html(""),$("#message_info_all_params_2").html(""),$("#message_info_all_params_3").html(""),$("#message_info_all_params_4").html("");var params={};$("#message_info_all_title").html("调试跟踪:"+data.bcjson.traceId),$("#message_info_all_params_1").html(data.bcjson.msg);var paramApi="请求API： "+api_name+",<br />入参：";return data.bcjson.reqParam&&$("#message_info_all_params_2").html(paramApi+data.bcjson.reqParam.replace(/,/g,",<br />")),data.bcjson.currentParam?$("#message_info_all_params_3").html(data.bcjson.currentParam.replace(/,/g,",<br />")):$("#message_info_all_params_3").html(""),cbfunc(data),!1}cbfunc(data)}})},doKoauthCode:function(a,e){var t=$.kingdom.getCodeAjaxParams(a,e);$.post("/code",t,function(a){e&&e(a)},"json")},doKoauthAPISync:function doKoauthAPISync(api_name,api_version,api_params,cbfunc){var param=$.kingdom.getAjaxParams(api_name,api_version,api_params);$.ajax({type:"post",url:"/api",dataType:"json",data:param,async:!1}).done(function(data){"object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&cbfunc(data)})},doCloudKoauthAPI:function(a,e,t,n){var o=$.kingdom.getAjaxParams(a,e,t);$.post("/api_cloud",o,function(a){n&&n(a)},"json")},doCloudKoauthAPISync:function doCloudKoauthAPISync(api_name,api_version,api_params,cbfunc){var param=$.kingdom.getAjaxParams(api_name,api_version,api_params);$.ajax({type:"post",url:"/api_cloud",dataType:"json",data:param,async:!1}).done(function(data){"object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&cbfunc(data)})},doDevToolApi:function doDevToolApi(api_service,api_params,cbfunc){var param=$.kingdom.getAjaxParams("api_name","api_version",api_params),reqUrl="/retl/rest/common/devtool/"+api_service+".json";$.ajax({type:"post",url:reqUrl,dataType:"json",data:param,async:!0}).done(function(data){"object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&cbfunc(data)})},getLoginName:function(e){$.ajax({url:"/krcs/login_name",data:{},type:"post",dataType:"json",success:function(a){e&&e(a)},error:function(a,e){if("timeout"==e)return!(window.location.href="/login.html")}})},getRedirect:function(t){$.ajax({type:"post",url:"/redirect",dataType:"json",async:!0}).done(function(a){var e="";"1"==a.bcjson.flag&&(e=a.bcjson.items[0].redirect),t&&t(e)})},logout:function logout(cbfunc){api_name="kingdom.ktrade.set_dis_employee_login_out",api_version="v4.0",api_params={loginName:$(".username").html().trim()},$.kingdom.log("\n\n\n======"+$.kingdom.dateFormat("yyyy-MM-dd hh:mm:ss")+"\t"+document.location.href+"\n======begin call api:"+api_name+" ,version:"+api_version),$.kingdom.log("======api params:"+JSON.stringify(api_params||{}));var $this=this,param=$.kingdom.getAjaxParams(api_name,api_version,api_params),url="/admin_api";url="/retl/rest/admin/"+$.trim(api_version)+"/"+$.trim(api_name)+".json",$.ajax({type:"get",url:url,dataType:"json",data:param,async:!1,beforeSend:function(a){a.setRequestHeader("X-Kweb-Menu-Id","id1122333"),a.setRequestHeader("X-Kweb-Op-Id","op_id1122333"),a.setRequestHeader("X-Kweb-Req-Trace-Id","rt1122333"),a.setRequestHeader("X-Kweb-Location-Href",document.location.href),a.setRequestHeader("X-Kweb-Timestamp",(new Date).getTime()+""),a.setRequestHeader("X-Kweb-Sign",$.md5(document.location.href)),a.setRequestHeader("X-Kweb-Api-Name",$.trim(api_name)),a.setRequestHeader("X-Kweb-Api-Version",$.trim(api_version)),a.setRequestHeader("X-Kweb-Api-Async",!1)}}).done(function(data){if($.kingdom.log("======api return result:"+JSON.stringify(data||{})),data&&data.bcjson&&data.bcjson.flag){var flag=data.bcjson.flag;"0"==flag&&console}if("object"!=(void 0===data?"undefined":_typeof(data))&&(data=eval("("+data+")")),cbfunc&&data){if(!data.bcjson)return!1;var flag=data.bcjson.flag;if("0"!=flag&&"1"!=flag)return $this.logout(function(){document.location.href="/login.html"}),!1;if(-1<data.bcjson.msg.indexOf("请求处理异常")&&1==$.kingdom.logShow){$("#message_info_all").modal("show");var items=data.bcjson.msg,params={};params.titleIndex=items.indexOf("请求处理异常"),params.paramIndex=items.indexOf("入参"),params.contentIndex=items.indexOf("异常堆栈");var title=items.substring(params.titleIndex,params.paramIndex),param=items.substring(params.paramIndex,params.contentIndex),content=items.substring(params.contentIndex,items.length);return 50<title.length&&(title=title.substring(0,50)+"..."),param="请求API: "+api_name+" <br />"+param,param=param.replace(/,/g,",<br />"),content=content.replace(/at /g," <br /> at "),$("#message_info_all_title").html(title),$("#message_info_all_params").html(param),$("#message_info_all_content").html(content),!1}cbfunc(data)}})},getAjaxParams:function(a,e,t){if($.kingdom.testMode){var n={};return n.p=JSON.stringify(t),n._ts=(new Date).getTime(),n}if(random)return 0==random?$.kingdom.get16(a,e,t):1==random?$.kingdom.getK(a,e,t):$.kingdom.getL(a,e,t)},getCodeAjaxParams:function(a){var e={};return e["kingdom"+(new Date).getTime()]=$.base64.encode(encodeURIComponent(JSON.stringify(a))),e},get16:function(a,e,t){var n={},o=(new Date).getTime()+"",r=JSON.stringify(t);return n._0x0111=$.base64.encode(o),n._0x1011=$.base64.encode(a),n._0x1100=$.base64.encode(e),n._0x1110=$.base64.encode(encodeURIComponent(r)),n._0x1001=$.md5(n._0x0111+n._0x1011+n._0x1100+n._0x1110).toUpperCase(),n._0x1101=$.base64.encode(document.location.href),n},getK:function(a,e,t){var n={},o=(new Date).getTime()+"",r=JSON.stringify(t);return n.KInGDOM=$.base64.encode(o),n.KINGdOM=$.base64.encode(a),n.KINGDoM=$.base64.encode(e),n.KiNGDOM=$.base64.encode(encodeURIComponent(r)),n.kINGDOM=$.md5(n.KiNGDOM+n.KINGDoM+n.KInGDOM+n.KINGdOM).toUpperCase(),n.KINgDOM=$.base64.encode(document.location.href),n.KINGDOm=$.base64.encode(document.location.protocol),n},getL:function(a,e,t){var n={},o=(new Date).getTime()+"",r=JSON.stringify(t);return n.css=$.base64.encode(o),n.android=$.base64.encode(a),n.html=$.base64.encode(e),n.ios=$.base64.encode(encodeURIComponent(r)),n.js=$.md5(n.ios+n.android+n.css+n.html).toUpperCase(),n.wp=$.base64.encode(document.location.href),n},upload:function upload(form_id,cbfunc){var options={url:"/krcs/file/upload",type:"POST",dataType:"json",success:function success(data){var jsondata={};jsondata="string"==typeof data?eval("("+data+")"):data,cbfunc&&cbfunc(jsondata)},error:function error(e){var jsondata={};jsondata="string"==typeof e.responseText?eval("("+e.responseText+")"):e,cbfunc&&cbfunc(jsondata)}};$("#"+form_id).ajaxSubmit(options)},cutimage:function cutimage(form_id,cbfunc){var options={url:"/cutimage",type:"POST",dataType:"json",success:function success(data){var jsondata={};jsondata="string"==typeof data?eval("("+data+")"):data,cbfunc&&cbfunc(jsondata)},error:function error(e){var jsondata={};jsondata="string"==typeof e.responseText?eval("("+e.responseText+")"):data,cbfunc&&cbfunc(jsondata)}};$("#"+form_id).ajaxSubmit(options)},getUrlParameter:function(a){var e=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(e);return null!=t?decodeURI(t[2]):null},getCookieParameter:function(a){var e=new RegExp(a+"=([^;]*)(;|$)","i"),t=document.cookie.match(e);return null!=t?$.base64.decode(decodeURI(t[1])):null},setParameter:function(a,e){window.sessionStorage.setItem(a,e)},getParameter:function(a){var e=window.sessionStorage.getItem(a);return e&&""!=e?e:""},delParameter:function(a){window.sessionStorage.removeItem(a)},fixMoney:function(a,e){if(!a)return"0.00";e=0<e&&e<=20?e:2;var n=(a=parseFloat((a+"").replace(/[^\d\.-]/g,"")).toFixed(e)+"").split(".")[0].split("").reverse(),o=a.split(".")[1];for(t="",i=0;i<n.length;i++)t+=n[i]+((i+1)%3==0&&i+1!=n.length?",":"");return t.split("").reverse().join("")+"."+o},toDate:function(a){return a?(a=a.toString()).substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8):""},replaceString:function(a,e,t){t=t||"*";var n=a.length;j="";for(var o=n-e;0<o;o--)j=t.concat(j);return a.replace(a.substr(e,n-e),j)},uniqueArray:function(a){for(var e={},t=[],n=0;n<a.length;n++)e[a[n]]||(e[a[n]]=!0,t.push(a[n]));return t},generateTree:function(a,o,r,i,e,t){o=o||"id",r=r||"parentId",i=i||"children",t=t||"asc";var s=[],n=[],m={};return $.each(a,function(a,e){m[e[r]]||(m[e[r]]=1)}),$.each(a,function(a,e){void 0===e[i]&&(e[i]=[]),1==m[e[o]]?s.push(e):n.push(e)}),e&&$.kingdom.quickSort(n,0,n.length-1,e,t),n.length==a.length?($.each(n,function(a,e){e.children&&0!=e.children.length||(e.type="leaf")}),n):($.each(n,function(a,t){var n=!1;$.each(s,function(a,e){if(t[r]==e[o])return e[i].push(t),e.type="node",!(n=!0)}),$.each(s,function(a,e){$.kingdom.quickSort(e[i],0,e[i].length-1,o,"asc")}),0==n&&s.push(t)}),$.kingdom.generateTree(s,o,r,i,e,t))},quickSort:function(a,e,t,n,o){if(e<t){var r=function(a,e,t,n,o){if(a[t][n]=isNaN(a[t][n])?a[t][n]:parseFloat(a[t][n]),a[e][n]=isNaN(a[e][n])?a[e][n]:parseFloat(a[e][n]),"asc"==o){for(;e<t;){for(;e<t&&a[e][n]<=a[t][n];)t--;var r=a[e];for(a[e]=a[t],a[t]=r;e<t&&a[e][n]<=a[t][n];)e++;r=a[e],a[e]=a[t],a[t]=r}return e}if("desc"==o){for(;t<e;){for(;t<e&&a[e][n]>=a[t][n];)t--;r=a[e];for(a[e]=a[t],a[t]=r;t<e&&a[e][n]>=a[t][n];)e++;r=a[e],a[e]=a[t],a[t]=r}return e}}(a,e,t,n,o);$.kingdom.quickSort(a,e,r-1,n,o),$.kingdom.quickSort(a,r+1,t,n,o)}},getDateStr:function(a,e){e=e||"";var t=new Date;t.setDate(t.getDate()+a);var n=t.getFullYear(),o=t.getMonth()+1,r=t.getDate();return n+""+e+(o<=9?"0"+o:o)+e+(r<=9?"0"+r:r)},fixMoneyBig:function(a){var e="",t="仟佰拾亿仟佰拾万仟佰拾圆角分",n=(a+="00").indexOf(".");0<=n&&(a=a.substring(0,n)+a.substr(n+1,2)),t=t.substr(t.length-a.length);for(var o=0;o<a.length;o++)e+="零壹贰叁肆伍陆柒捌玖".substr(a.substr(o,1),1)+t.substr(o,1);return e.replace(/零角零分$/,"整").replace(/零[仟佰拾]/g,"零").replace(/零{2,}/g,"零").replace(/零([亿|万])/g,"$1").replace(/零+圆/,"圆").replace(/亿零{0,3}万/,"亿").replace(/^圆/,"零圆")},openWin:function(a){var e=document.createElement("a");e.setAttribute("href",a),e.setAttribute("id","openwin"),document.body.appendChild(e),e.click(),$(e).remove()},draggable:function(a,e){var t=$(a);t.draggable({cursor:"move",handle:".modal-header"}),e?t.modal(e):t.modal("hide")},textCounter:function(a,e){$(a).after(" 还可输入<span>"+e+"</span>/<span>"+e+"</span>个字符"),$(a).on("input","",function(a){!function(a,e){var t=$(a).next();a.val().length>e?a.val(a.val().substring(0,e)):t.text(e-a.val().length)}($(this),$(this).next().next().text())})},animateMarginLeft:function(a,e){var t=e||300;$("#J_sheet_tabs").animate({"margin-left":a},t)},ls:{set:function(a,e,t){var n={};n.data=e,n.expire=t&&0<t?(new Date).getTime()/6e4+t:0,window.localStorage.setItem(a,JSON.stringify(n))},get:function(a){try{(e=JSON.parse(window.localStorage.getItem(a)))?0<e.expire&&e.expire<=(new Date).getTime()/6e4?(e="",window.localStorage.removeItem(a)):e=e.data:e=""}catch(a){var e=""}return e},del:function(a){window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()}}}});try{seajs&&define(function(require,exports,module){module.exports=jQuery.kingdom})}catch(a){}