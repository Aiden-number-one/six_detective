if("undefined"==typeof jQuery)throw new Error("kweb.kdata requires jQuery");seajs&&define(function(require,exports,module){var u=require("json2"),g=g||{};g.context="/krcs",g.ajax=$.ajax,g.uuid=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},g.dateFormat=function(e){var t=new Date,n={"Y+":t.getYear(),"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var o in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("00"+n[o]).substr((""+n[o]).length)));return e},g.getFrontApiJsonAsync=function(e,t,n,o){var s=g.context+"/rest/"+$.trim(t)+"/"+$.trim(e)+".json";g.getAsync(s,e,t,n,o)},g.getBackApiJsonAsync=function(e,t,n,o){var s=g.context+"/rest/admin/"+$.trim(t)+"/"+$.trim(e)+".json";g.getAsync(s,e,t,n,o)},g.getAsync=function(e,t,n,o,s){g.getJsonData("get",e,!0,t,n,o,s)},g.getSync=function(e,t,n,o,s){g.getJsonData("get",e,!1,t,n,o,s)},g.postAsync=function(e,t,n,o,s){g.getJsonData("post",e,!0,t,n,o,s)},g.postSync=function(e,t,n,o,s){g.getJsonData("post",e,!1,t,n,o,s)},g.getJsonData=function(e,t,n,o,s,a,r){var i={};i.p=u.stringify(a||{}),i._ts=(new Date).getTime();var c=g.dateFormat("YYYY-MM-dd hh:mm:ss.S");g.ajax({type:e,url:t,dataType:"json",data:i,async:n,beforeSend:function(e){e.setRequestHeader("X-Kweb-Menu-Id",window.location.pathname+window.location.hash),e.setRequestHeader("X-Kweb-Op-Id","????op_id1122333"),e.setRequestHeader("X-Kweb-Req-Trace-Id",g.uuid()),e.setRequestHeader("X-Kweb-Location-Href",document.location.href),e.setRequestHeader("X-Kweb-Timestamp",c),e.setRequestHeader("X-Kweb-Sign",$.md5(c+i.p)),e.setRequestHeader("X-Kweb-Api-Name",$.trim(o)),e.setRequestHeader("X-Kweb-Api-Version",$.trim(s))}}).done(function(e){e&&e.bcjson&&e.bcjson.flag&&"0"==e.bcjson.flag&&console&&console.info(window.location.href," --\x3e ",e);r&&r(e)})},module.exports=g});