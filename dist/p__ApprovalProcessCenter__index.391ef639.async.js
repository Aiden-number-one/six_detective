(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"2Cab":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var r=n(a("qIgq")),u=l(a("q1tI")),c=a("Hx5s"),d=n(a("c2Ae")),o=n(a("ifr9")),s=n(a("mR9m"));function i(){var e=(0,u.useState)(null),t=(0,r.default)(e,2),a=t[0],l=t[1],n=(0,u.useState)(null),i=(0,r.default)(n,2),f=i[0],p=i[1];return u.default.createElement(c.PageHeaderWrapper,null,u.default.createElement("div",{className:s.default["list-container"]},u.default.createElement(o.default,{getTask:function(e){return l(e)},setCurrentTaskType:function(e){return p(e)}}),u.default.createElement(d.default,{task:a,currentTaskType:f})))}},GybK:function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmModel=u,a("2qtc");var n=l(a("kLXV")),r=l(a("q1tI"));function u(e){var t=e.title,a=e.confirmVisible,l=e.comfirm,u=e.content,c=e.closeModel;return r.default.createElement(n.default,{title:t,visible:a,onOk:l,onCancel:c},r.default.createElement("p",null,u))}},c2Ae:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var r=n(a("/wGt"));a("+L6B");var u=n(a("2/Rp"));a("7Kak");var c=n(a("9yH6"));a("miYZ");var d=n(a("tsqr")),o=n(a("qIgq"));a("Q9mQ");var s=n(a("diRs"));a("14J3");var i=n(a("BMrR"));a("jCWc");var f=n(a("kPKH"));a("Mwp2");var p=n(a("VXEj"));a("y8nQ");var m=n(a("Vl3Y"));a("tU7J");var E=n(a("wFql"));a("5NDa");var v=n(a("5rEg"));a("Znn+");var g=n(a("ZTPi")),y=l(a("q1tI")),k=a("LLXN"),C=a("MuoO"),h=n(a("BN5G")),b=a("GybK"),x=n(a("mR9m")),T=g.default.TabPane,I=v.default.TextArea,w=E.default.Paragraph,N=E.default.Text;function S(e){var t=e.form,a=e.detailItem,l=e.task,n=t.getFieldDecorator,r=l&&a.data||[],u=a.isStarter;return console.log("detailItem----\x3e",a.data),y.default.createElement(y.default.Fragment,null,u&&r.length?y.default.createElement(m.default,null,r.map(function(e){return y.default.createElement(m.default.Item,{label:e.key,labelCol:{span:5},wrapperCol:{span:16}},n(e.key,{initialValue:e.oldValue})(y.default.createElement(v.default,{disabled:!e.isEdit})))})):y.default.createElement("div",{className:x.default.ListBox},y.default.createElement(p.default,{header:l&&r.length>0&&y.default.createElement(p.default.Item,null,y.default.createElement("div",{className:x.default.ListItem},y.default.createElement("p",null),y.default.createElement("p",null,"New INFO"),y.default.createElement("p",null,"Old INFO"))),bordered:!0,dataSource:r,renderItem:function(e){return y.default.createElement(p.default.Item,null,y.default.createElement("div",{className:x.default.ListItem},y.default.createElement("p",null,e.key),y.default.createElement("p",null,e.newValue),y.default.createElement("p",null,e.oldValue)))}})))}var A=m.default.create()(S);function L(e){var t=e.attachments;return y.default.createElement(s.default,{placement:"bottomRight",title:y.default.createElement(k.FormattedMessage,{id:"alert-center.attachement-list"}),content:y.default.createElement(i.default,{style:{padding:"6px 14px",width:240,maxHeight:150,overflowY:"auto"}},t.map(function(e,t){var a=e.name,l=e.url;return y.default.createElement(f.default,{key:l},y.default.createElement(N,{ellipsis:!0,style:{width:"100%"},title:a},y.default.createElement("a",{download:!0,href:"/download?filePath=".concat(l),style:{marginBottom:20}},t+1,". ",a)))}))},y.default.createElement(h.default,{type:"iconbiezhen"}),t.length)}function M(e){var t=e.comment,a=t.time,l=t.text,n=t.attachments;return y.default.createElement("li",{key:"".concat(a,"-").concat(l)},y.default.createElement(i.default,null,y.default.createElement(f.default,{span:18,style:{color:"#0D87D4"}},a),y.default.createElement(f.default,{span:5,offset:1,align:"right"},n&&y.default.createElement(L,{attachments:n}))),y.default.createElement(i.default,null,y.default.createElement(w,{ellipsis:{rows:3,expandable:!0}},l)))}function R(e){var t=e.log,a=t.time,l=t.text;return y.default.createElement(y.default.Fragment,null,y.default.createElement(f.default,{span:9},a),y.default.createElement(f.default,{span:15},y.default.createElement(w,{ellipsis:{rows:3,expandable:!0}},l)))}function D(e){var t=e.dispatch,a=e.task,l=e.detailItems,n=e.taskGroup,s=e.submitRadioList,p=e.currentTaskType,m=(0,y.useState)(!1),E=(0,o.default)(m,2),v=E[0],k=E[1],C=(0,y.useState)(!1),w=(0,o.default)(C,2),N=w[0],S=w[1],L=(0,y.useState)(""),D=(0,o.default)(L,2),F=D[0],O=D[1],P=(0,y.useState)(""),j=(0,o.default)(P,2),B=j[0],G=j[1],_=(0,y.useState)(!1),q=(0,o.default)(_,2),V=q[0],K=q[1],U=(0,y.useState)(!1),H=(0,o.default)(U,2),X=H[0],z=H[1],W=y.default.createRef();function J(e){if(G(e),"reject"!==e){if(!n||n.nextRelateNo)return n?(S(!0),void Q()):void d.default.error("submit failure");Y(e)}else K(!0)}function Y(e){var n="";"submit"===e&&W.current.validateFields(function(e,t){n=[];var a=l.data;e||(console.log("Received values of form: ",t),a.map(function(e){e.isEdit&&n.push(t[e.key])}),n=n.join(","))}),"reject"===e&&K(!1),t({type:"approvalCenter/approveAndReject",payload:{taskCode:a.taskCode,type:e,userId:F,epCname:n},callback:function(){t({type:"approvalCenter/fetch",payload:{type:p}})}}),S(!1)}function Z(){t({type:"approvalCenter/setTaskWithdraw",payload:{taskCode:a.taskCode,comment:""},callback:function(){t({type:"approvalCenter/fetch",payload:{type:p,taskCode:a.taskCode}})}}),z(!1)}function Q(){t({type:"approvalCenter/fetchUserList",payload:{operType:"queryByAlertGroupId",groupId:n.nextRelateNo}})}function $(){W.current.validateFields(function(e,n){var r=[],u=l.data;e||(console.log("Received values of form: ",n),u.map(function(e){e.isEdit&&r.push(n[e.key])}),r=r.join(",")),t({type:"approvalCenter/saveTask",payload:{taskCode:a.taskCode,epCname:r}})})}return console.log("detailItem--000--\x3e",F,n),(0,y.useEffect)(function(){a&&t({type:"approvalCenter/fetchTaskDetail",payload:{taskCode:a.taskCode}})},[a]),(0,y.useEffect)(function(){a&&t({type:"approvalCenter/featchTaskGroup",payload:{taskCode:a.taskCode}})},[a]),y.default.createElement(y.default.Fragment,null,y.default.createElement(b.ConfirmModel,{title:"CONFIRM",content:"Do you comfirm to reject this task?",closeModel:function(){return K(!1)},confirmVisible:V,comfirm:function(){return Y(B)}}),y.default.createElement(b.ConfirmModel,{title:"CONFIRM",content:"Do you comfirm to withdraw this task?",closeModel:function(){return z(!1)},confirmVisible:X,comfirm:Z}),y.default.createElement(i.default,{className:x.default["detail-container"],gutter:16},y.default.createElement(f.default,{span:16,className:v?x.default.fullscreen:""},y.default.createElement(g.default,{hideAdd:!0,className:x.default["detail-des"],defaultActiveKey:"1",tabBarExtraContent:y.default.createElement(h.default,{type:v?"iconfullscreen-exit":"iconfull-screen",className:x.default["fullscreen-icon"],onClick:function(){return k(!v)}})},y.default.createElement(T,{className:x.default["tab-content"],closable:!1,tab:"Task Detail",key:""},y.default.createElement(A,{ref:W,saveTask:$,detailItem:l,task:a}),y.default.createElement(r.default,{title:"Assign to",width:500,visible:N,onClose:function(){return S(!1)},bodyStyle:{paddingBottom:80}},y.default.createElement(c.default.Group,{options:s,onChange:function(e){return O(e.target.value)},value:F}),y.default.createElement("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},y.default.createElement(u.default,{onClick:function(){return Y(B)},type:"primary"},"Save"),y.default.createElement(u.default,{onClick:function(){return S(!1)},style:{marginRight:12}},"Cancel")))))),y.default.createElement(f.default,{span:8},y.default.createElement(g.default,{defaultActiveKey:"1",className:x.default["detail-comment"]},y.default.createElement(T,{tab:"Approval History",key:"1"},y.default.createElement("ul",{className:x.default["comment-ul"]},alert.comments&&alert.comments.map(function(e){return y.default.createElement(M,{comment:e,key:e.time})})),y.default.createElement("div",{className:x.default["comment-box"]},y.default.createElement(I,{placeholder:"COMMENT",className:x.default.txt}),y.default.createElement(i.default,{className:x.default["comment-commit"],type:"flex",align:"middle",justify:"space-between"},l.isStarter?y.default.createElement(y.default.Fragment,null,y.default.createElement(f.default,{span:6},y.default.createElement(u.default,{style:{margin:"0 10px"},type:"primary",onClick:function(){return J("submit")}},"Submit")),y.default.createElement(f.default,{span:6,align:"right"},y.default.createElement(u.default,{style:{margin:"0 10px"},type:"primary",onClick:$},"Save"))):y.default.createElement(y.default.Fragment,null,y.default.createElement(f.default,{span:6},y.default.createElement(u.default,{type:"primary",onClick:function(){return J("pass")}},"Approve")),y.default.createElement(f.default,{span:6},y.default.createElement(u.default,{type:"primary",onClick:function(){return J("reject")}},"Reject"))),y.default.createElement(f.default,{span:6},y.default.createElement(u.default,{onClick:function(){return z(!0)},type:"primary"},"Withtraw"))))),y.default.createElement(T,{className:x.default["tab-content"],tab:"Task Lifecycle",key:"2"},y.default.createElement(i.default,{gutter:[10,10],style:{height:440,overflowY:"auto"}},alert.logs&&alert.logs.map(function(e){return y.default.createElement(R,{log:e,key:e.time})})))))))}var F=(0,C.connect)(function(e){var t=e.loading,a=e.approvalCenter,l=a.detailItems,n=a.userList,r=a.submitRadioList,u=a.taskGroup;return{detailItems:l,userList:n,submitRadioList:r,taskGroup:u,loading:t.effects}})(D);t.default=F},ifr9:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DEFAULT_PAGE_SIZE=t.DEFAULT_PAGE=void 0;var r=n(a("d6i3"));a("2qtc");var u=n(a("kLXV")),c=n(a("1l/V")),d=n(a("qIgq"));a("+L6B");var o=n(a("2/Rp"));a("14J3");var s=n(a("BMrR"));a("jCWc");var i=n(a("kPKH"));a("7Kak");var f=n(a("9yH6"));a("5NDa");var p=n(a("5rEg"));a("g9YV");var m=n(a("wCAj")),E=l(a("q1tI")),v=a("MuoO"),g=a("LLXN"),y=n(a("BN5G")),k=a("+n12"),C=n(a("mR9m")),h=m.default.Column,b=p.default.Search,x=1;t.DEFAULT_PAGE=x;var T=10;function I(e){var t=e.changeTab;return E.default.createElement(s.default,{className:C.default.btns},E.default.createElement(i.default,{span:12},E.default.createElement(f.default.Group,{defaultValue:"all",onChange:function(e){return t(e.target.value)}},E.default.createElement(f.default.Button,{value:"all"},"All Task"),E.default.createElement(f.default.Button,{value:"my"},"My task"))))}function w(e){var t=e.selectedKeys,a=e.selectedCurrentTask,l=e.searchTask,n=e.urlTaskCode,r=e.claimOk,u=e.setTaskAssign,c=e.exportAlert;return E.default.createElement(s.default,{className:C.default.btns},E.default.createElement(i.default,{span:12},E.default.createElement(o.default,{disabled:!t.length,onClick:function(){return r(t)}},E.default.createElement(y.default,{type:"iconicon_Claim",className:C.default["btn-icon"]}),E.default.createElement(g.FormattedMessage,{id:"alert-center.claim"})),E.default.createElement(o.default,{disabled:!t.length,onClick:function(){return u(t)}},E.default.createElement(y.default,{type:"iconicon_assign",className:C.default["btn-icon"]}),"Assign"),E.default.createElement(o.default,{disabled:!t.length,onClick:c},E.default.createElement(y.default,{type:"iconicon_export",className:C.default["btn-icon"]}),E.default.createElement(g.FormattedMessage,{id:"alert-center.export"}))),E.default.createElement(i.default,{span:6},E.default.createElement(b,{placeholder:"search",defaultValue:n,onSearch:function(e){return l(a,e)},style:{width:264,height:36}})))}function N(e){var t=e.dispatch,a=e.loading,l=e.tasks,n=e.detailItems,o=e.total,i=e.getTask,f=e.setCurrentTaskType,p=(0,E.useState)([]),v=(0,d.default)(p,2),b=v[0],x=v[1],T=(0,E.useState)("all"),N=(0,d.default)(T,2),S=N[0],A=N[1],L=(0,E.useState)("1"),M=(0,d.default)(L,2),R=M[0],D=M[1],F=(0,E.useState)("1"),O=(0,d.default)(F,2),P=O[0],j=O[1],B=(0,k.GetQueryString)("taskcode");function G(e){return _.apply(this,arguments)}function _(){return _=(0,c.default)(r.default.mark(function e(a){return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"approvalCenter/fetchTaskDetail",payload:{taskCode:a}});case 2:n.ownerId?u.default.confirm({title:"Confirm",content:"This task has been claimed by [".concat(n.ownerId,"]\n      Do you confirm to re-claim"),okText:"Sure",cancelText:"Cancel",onOk:function(){q(a)}}):q(a);case 3:case"end":return e.stop()}},e)})),_.apply(this,arguments)}function q(e){t({type:"approvalCenter/claim",payload:{taskCode:e},callback:function(){t({type:"approvalCenter/fetch",payload:{type:S,taskCode:e}})}})}function V(e){console.log("taskCode-----------\x3e",e),t({type:"approvalCenter/setTaskAssign",payload:{taskCode:e,userId:""}})}function K(e,a){t({type:"approvalCenter/fetch",payload:{taskCode:a,type:e}})}return console.log("urlTaskCode------\x3e",B),(0,E.useEffect)(function(){t({type:"approvalCenter/fetch",payload:{taskCode:B}}),t({type:"approvalCenter/getUserListByUserId",payload:{}})},[]),(0,E.useEffect)(function(){if(l&&l.length>0){var e=(0,d.default)(l,1),t=e[0];i(t),j(t),f(S)}else i(!1)},[l]),E.default.createElement("div",{className:C.default.list},E.default.createElement(I,{changeTab:function(e){A(e),f(S),t({type:"approvalCenter/fetch",payload:{type:e}})}}),E.default.createElement(w,{selectedKeys:b,selectedCurrentTask:S,searchTask:K,urlTaskCode:B,claimOk:q,setTaskAssign:V}),E.default.createElement(m.default,{border:!0,dataSource:l,rowKey:"taskCode",loading:a["approvalCenter/fetch"],rowClassName:function(e){return e.taskCode===P.taskCode?"active":""},rowSelection:{onChange:function(e){x(e)}},pagination:{total:o,showSizeChanger:!0,showTotal:function(e){return"Page ".concat(R," of ").concat(Math.ceil(e/10).toString())},onChange:function(e,a){D(e),t({type:"approvalCenter/fetch",payload:{page:e,pageSize:a,type:S}})},onShowSizeChange:function(e,a){D(e),t({type:"approvalCenter/fetch",payload:{page:e,pageSize:a,type:S}})}},onRow:function(e){return{onClick:function(){i(e),j(e)}}}},E.default.createElement(h,{align:"center",dataIndex:"taskCode",title:"TASK CODE"}),E.default.createElement(h,{align:"center",dataIndex:"classification",title:"CLASSIFICATION"}),E.default.createElement(h,{align:"center",dataIndex:"submitterName",title:"SUBMITTER NAME"}),E.default.createElement(h,{align:"center",dataIndex:"details",title:"DETAILS"}),E.default.createElement(h,{align:"center",dataIndex:"updateDate",title:"UPDATE DATE"}),E.default.createElement(h,{dataIndex:"owner",title:"OWNER"}),E.default.createElement(h,{align:"center",dataIndex:"statusDesc",title:"statusDesc"}),E.default.createElement(h,{align:"center",dataIndex:"action",title:E.default.createElement(g.FormattedMessage,{id:"alert-center.action"}),render:function(e,t){return E.default.createElement(s.default,{className:C.default.btns},E.default.createElement(y.default,{type:"iconqizhi",className:C.default.icon,title:(0,g.formatMessage)({id:"alert-center.claim"}),onClick:function(){G([t.taskCode])}}))}})))}t.DEFAULT_PAGE_SIZE=T;var S=(0,v.connect)(function(e){var t=e.loading,a=e.approvalCenter,l=a.tasks,n=a.detailItems,r=a.page,u=a.total;return{tasks:l,page:r,total:u,detailItems:n,loading:t.effects}})(N);t.default=S},mR9m:function(e,t,a){e.exports={"list-container":"antd-pro-pages-approval-process-center-index-list-container",list:"antd-pro-pages-approval-process-center-index-list",btns:"antd-pro-pages-approval-process-center-index-btns","btn-icon":"antd-pro-pages-approval-process-center-index-btn-icon",icon:"antd-pro-pages-approval-process-center-index-icon","detail-container":"antd-pro-pages-approval-process-center-index-detail-container","tab-content":"antd-pro-pages-approval-process-center-index-tab-content",fullscreen:"antd-pro-pages-approval-process-center-index-fullscreen",ListBox:"antd-pro-pages-approval-process-center-index-ListBox",ListItem:"antd-pro-pages-approval-process-center-index-ListItem","detail-des":"antd-pro-pages-approval-process-center-index-detail-des","fullscreen-icon":"antd-pro-pages-approval-process-center-index-fullscreen-icon","detail-comment":"antd-pro-pages-approval-process-center-index-detail-comment","comment-ul":"antd-pro-pages-approval-process-center-index-comment-ul","comment-box":"antd-pro-pages-approval-process-center-index-comment-box",txt:"antd-pro-pages-approval-process-center-index-txt","comment-commit":"antd-pro-pages-approval-process-center-index-comment-commit"}}}]);